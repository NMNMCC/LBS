var Li=Object.create;var Gr=Object.defineProperty;var Ni=Object.getOwnPropertyDescriptor;var Mi=Object.getOwnPropertyNames;var $i=Object.getPrototypeOf,ji=Object.prototype.hasOwnProperty;var N=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var O=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var ki=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of Mi(t))!ji.call(e,s)&&s!==r&&Gr(e,s,{get:()=>t[s],enumerable:!(n=Ni(t,s))||n.enumerable});return e};var Di=(e,t,r)=>(r=e!=null?Li($i(e)):{},ki(t||!e||!e.__esModule?Gr(r,"default",{value:e,enumerable:!0}):r,e));var It=O((Nf,Kr)=>{"use strict";var Ie=e=>e&&typeof e.message=="string",Rt=e=>{if(!e)return;let t=e.cause;if(typeof t=="function"){let r=e.cause();return Ie(r)?r:void 0}else return Ie(t)?t:void 0},Jr=(e,t)=>{if(!Ie(e))return"";let r=e.stack||"";if(t.has(e))return r+`
causes have become circular...`;let n=Rt(e);return n?(t.add(e),r+`
caused by: `+Jr(n,t)):r},zi=e=>Jr(e,new Set),Hr=(e,t,r)=>{if(!Ie(e))return"";let n=r?"":e.message||"";if(t.has(e))return n+": ...";let s=Rt(e);if(s){t.add(e);let i=typeof e.cause=="function";return n+(i?"":": ")+Hr(s,t,i)}else return n},Bi=e=>Hr(e,new Set);Kr.exports={isErrorLike:Ie,getErrorCause:Rt,stackWithCauses:zi,messageWithCauses:Bi}});var At=O((Mf,Xr)=>{"use strict";var qi=Symbol("circular-ref-tag"),Ge=Symbol("pino-raw-err-ref"),Yr=Object.create({},{type:{enumerable:!0,writable:!0,value:void 0},message:{enumerable:!0,writable:!0,value:void 0},stack:{enumerable:!0,writable:!0,value:void 0},aggregateErrors:{enumerable:!0,writable:!0,value:void 0},raw:{enumerable:!1,get:function(){return this[Ge]},set:function(e){this[Ge]=e}}});Object.defineProperty(Yr,Ge,{writable:!0,value:{}});Xr.exports={pinoErrProto:Yr,pinoErrorSymbols:{seen:qi,rawSymbol:Ge}}});var en=O(($f,Qr)=>{"use strict";Qr.exports=Ct;var{messageWithCauses:Fi,stackWithCauses:Vi,isErrorLike:Zr}=It(),{pinoErrProto:Ui,pinoErrorSymbols:Wi}=At(),{seen:Tt}=Wi,{toString:Gi}=Object.prototype;function Ct(e){if(!Zr(e))return e;e[Tt]=void 0;let t=Object.create(Ui);t.type=Gi.call(e.constructor)==="[object Function]"?e.constructor.name:e.name,t.message=Fi(e),t.stack=Vi(e),Array.isArray(e.errors)&&(t.aggregateErrors=e.errors.map(r=>Ct(r)));for(let r in e)if(t[r]===void 0){let n=e[r];Zr(n)?r!=="cause"&&!Object.prototype.hasOwnProperty.call(n,Tt)&&(t[r]=Ct(n)):t[r]=n}return delete e[Tt],t.raw=e,t}});var rn=O((jf,tn)=>{"use strict";tn.exports=He;var{isErrorLike:Pt}=It(),{pinoErrProto:Ji,pinoErrorSymbols:Hi}=At(),{seen:Je}=Hi,{toString:Ki}=Object.prototype;function He(e){if(!Pt(e))return e;e[Je]=void 0;let t=Object.create(Ji);t.type=Ki.call(e.constructor)==="[object Function]"?e.constructor.name:e.name,t.message=e.message,t.stack=e.stack,Array.isArray(e.errors)&&(t.aggregateErrors=e.errors.map(r=>He(r))),Pt(e.cause)&&!Object.prototype.hasOwnProperty.call(e.cause,Je)&&(t.cause=He(e.cause));for(let r in e)if(t[r]===void 0){let n=e[r];Pt(n)?Object.prototype.hasOwnProperty.call(n,Je)||(t[r]=He(n)):t[r]=n}return delete e[Je],t.raw=e,t}});var an=O((kf,on)=>{"use strict";on.exports={mapHttpRequest:Yi,reqSerializer:sn};var Lt=Symbol("pino-raw-req-ref"),nn=Object.create({},{id:{enumerable:!0,writable:!0,value:""},method:{enumerable:!0,writable:!0,value:""},url:{enumerable:!0,writable:!0,value:""},query:{enumerable:!0,writable:!0,value:""},params:{enumerable:!0,writable:!0,value:""},headers:{enumerable:!0,writable:!0,value:{}},remoteAddress:{enumerable:!0,writable:!0,value:""},remotePort:{enumerable:!0,writable:!0,value:""},raw:{enumerable:!1,get:function(){return this[Lt]},set:function(e){this[Lt]=e}}});Object.defineProperty(nn,Lt,{writable:!0,value:{}});function sn(e){let t=e.info||e.socket,r=Object.create(nn);if(r.id=typeof e.id=="function"?e.id():e.id||(e.info?e.info.id:void 0),r.method=e.method,e.originalUrl)r.url=e.originalUrl;else{let n=e.path;r.url=typeof n=="string"?n:e.url?e.url.path||e.url:void 0}return e.query&&(r.query=e.query),e.params&&(r.params=e.params),r.headers=e.headers,r.remoteAddress=t&&t.remoteAddress,r.remotePort=t&&t.remotePort,r.raw=e.raw||e,r}function Yi(e){return{req:sn(e)}}});var fn=O((Df,ln)=>{"use strict";ln.exports={mapHttpResponse:Xi,resSerializer:un};var Nt=Symbol("pino-raw-res-ref"),cn=Object.create({},{statusCode:{enumerable:!0,writable:!0,value:0},headers:{enumerable:!0,writable:!0,value:""},raw:{enumerable:!1,get:function(){return this[Nt]},set:function(e){this[Nt]=e}}});Object.defineProperty(cn,Nt,{writable:!0,value:{}});function un(e){let t=Object.create(cn);return t.statusCode=e.headersSent?e.statusCode:null,t.headers=e.getHeaders?e.getHeaders():e._headers,t.raw=e,t}function Xi(e){return{res:un(e)}}});var $t=O((zf,dn)=>{"use strict";var Mt=en(),Zi=rn(),Ke=an(),Ye=fn();dn.exports={err:Mt,errWithCause:Zi,mapHttpRequest:Ke.mapHttpRequest,mapHttpResponse:Ye.mapHttpResponse,req:Ke.reqSerializer,res:Ye.resSerializer,wrapErrorSerializer:function(t){return t===Mt?t:function(n){return t(Mt(n))}},wrapRequestSerializer:function(t){return t===Ke.reqSerializer?t:function(n){return t(Ke.reqSerializer(n))}},wrapResponseSerializer:function(t){return t===Ye.resSerializer?t:function(n){return t(Ye.resSerializer(n))}}}});var jt=O((Bf,hn)=>{"use strict";function Qi(e,t){return t}hn.exports=function(){let t=Error.prepareStackTrace;Error.prepareStackTrace=Qi;let r=new Error().stack;if(Error.prepareStackTrace=t,!Array.isArray(r))return;let n=r.slice(2),s=[];for(let i of n)i&&s.push(i.getFileName());return s}});var mn=O((qf,pn)=>{"use strict";pn.exports=eo;function eo(e={}){let{ERR_PATHS_MUST_BE_STRINGS:t=()=>"fast-redact - Paths must be (non-empty) strings",ERR_INVALID_PATH:r=n=>`fast-redact \u2013 Invalid path (${n})`}=e;return function({paths:s}){s.forEach(i=>{if(typeof i!="string")throw Error(t());try{if(/ã€‡/.test(i))throw Error();let o=(i[0]==="["?"":".")+i.replace(/^\*/,"\u3007").replace(/\.\*/g,".\u3007").replace(/\[\*\]/g,"[\u3007]");if(/\n|\r|;/.test(o)||/\/\*/.test(o))throw Error();Function(`
            'use strict'
            const o = new Proxy({}, { get: () => o, set: () => { throw Error() } });
            const \u3007 = null;
            o${o}
            if ([o${o}].length !== 1) throw Error()`)()}catch{throw Error(r(i))}})}}});var Xe=O((Ff,gn)=>{"use strict";gn.exports=/[^.[\]]+|\[((?:.)*?)\]/g});var wn=O((Vf,yn)=>{"use strict";var to=Xe();yn.exports=ro;function ro({paths:e}){let t=[];var r=0;let n=e.reduce(function(s,i,o){var a=i.match(to).map(f=>f.replace(/'|"|`/g,""));let l=i[0]==="[";a=a.map(f=>f[0]==="["?f.substr(1,f.length-2):f);let d=a.indexOf("*");if(d>-1){let f=a.slice(0,d),u=f.join("."),m=a.slice(d+1,a.length),h=m.length>0;r++,t.push({before:f,beforeStr:u,after:m,nested:h})}else s[i]={path:a,val:void 0,precensored:!1,circle:"",escPath:JSON.stringify(i),leadingBracket:l};return s},{});return{wildcards:t,wcLen:r,secret:n}}});var Sn=O((Uf,bn)=>{"use strict";var no=Xe();bn.exports=so;function so({secret:e,serialize:t,wcLen:r,strict:n,isCensorFct:s,censorFctTakesPath:i},o){let a=Function("o",`
    if (typeof o !== 'object' || o == null) {
      ${co(n,t)}
    }
    const { censor, secret } = this
    const originalSecret = {}
    const secretKeys = Object.keys(secret)
    for (var i = 0; i < secretKeys.length; i++) {
      originalSecret[secretKeys[i]] = secret[secretKeys[i]]
    }

    ${io(e,s,i)}
    this.compileRestore()
    ${oo(r>0,s,i)}
    this.secret = originalSecret
    ${ao(t)}
  `).bind(o);return a.state=o,t===!1&&(a.restore=l=>o.restore(l)),a}function io(e,t,r){return Object.keys(e).map(n=>{let{escPath:s,leadingBracket:i,path:o}=e[n],a=i?1:0,l=i?"":".",d=[];for(var f;(f=no.exec(n))!==null;){let[,c]=f,{index:y,input:g}=f;y>a&&d.push(g.substring(0,y-(c?0:1)))}var u=d.map(c=>`o${l}${c}`).join(" && ");u.length===0?u+=`o${l}${n} != null`:u+=` && o${l}${n} != null`;let m=`
      switch (true) {
        ${d.reverse().map(c=>`
          case o${l}${c} === censor:
            secret[${s}].circle = ${JSON.stringify(c)}
            break
        `).join(`
`)}
      }
    `,h=r?`val, ${JSON.stringify(o)}`:"val";return`
      if (${u}) {
        const val = o${l}${n}
        if (val === censor) {
          secret[${s}].precensored = true
        } else {
          secret[${s}].val = val
          o${l}${n} = ${t?`censor(${h})`:"censor"}
          ${m}
        }
      }
    `}).join(`
`)}function oo(e,t,r){return e===!0?`
    {
      const { wildcards, wcLen, groupRedact, nestedRedact } = this
      for (var i = 0; i < wcLen; i++) {
        const { before, beforeStr, after, nested } = wildcards[i]
        if (nested === true) {
          secret[beforeStr] = secret[beforeStr] || []
          nestedRedact(secret[beforeStr], o, before, after, censor, ${t}, ${r})
        } else secret[beforeStr] = groupRedact(o, before, censor, ${t}, ${r})
      }
    }
  `:""}function ao(e){return e===!1?"return o":`
    var s = this.serialize(o)
    this.restore(o)
    return s
  `}function co(e,t){return e===!0?"throw Error('fast-redact: primitives cannot be redacted')":t===!1?"return o":"return this.serialize(o)"}});var Dt=O((Wf,vn)=>{"use strict";vn.exports={groupRedact:lo,groupRestore:uo,nestedRedact:ho,nestedRestore:fo};function uo({keys:e,values:t,target:r}){if(r==null||typeof r=="string")return;let n=e.length;for(var s=0;s<n;s++){let i=e[s];r[i]=t[s]}}function lo(e,t,r,n,s){let i=xn(e,t);if(i==null||typeof i=="string")return{keys:null,values:null,target:i,flat:!0};let o=Object.keys(i),a=o.length,l=t.length,d=s?[...t]:void 0,f=new Array(a);for(var u=0;u<a;u++){let m=o[u];f[u]=i[m],s?(d[l]=m,i[m]=r(i[m],d)):n?i[m]=r(i[m]):i[m]=r}return{keys:o,values:f,target:i,flat:!0}}function fo(e){for(let t=0;t<e.length;t++){let{target:r,path:n,value:s}=e[t],i=r;for(let o=n.length-1;o>0;o--)i=i[n[o]];i[n[0]]=s}}function ho(e,t,r,n,s,i,o){let a=xn(t,r);if(a==null)return;let l=Object.keys(a),d=l.length;for(var f=0;f<d;f++){let u=l[f];po(e,a,u,r,n,s,i,o)}return e}function kt(e,t){return e!=null?"hasOwn"in Object?Object.hasOwn(e,t):Object.prototype.hasOwnProperty.call(e,t):!1}function po(e,t,r,n,s,i,o,a){let l=s.length,d=l-1,f=r;var u=-1,m,h,c,y=null,g=null,S,w,b=!1,x=0,v=0,_=mo();if(c=m=t[r],typeof m=="object"){for(;m!=null&&++u<l&&(v+=1,r=s[u],y=c,!(r!=="*"&&!g&&!(typeof m=="object"&&r in m)));)if(!(r==="*"&&(g==="*"&&(b=!0),g=r,u!==d))){if(g){let I=Object.keys(m);for(var R=0;R<I.length;R++){let E=I[R];if(w=m[E],S=r==="*",b)_=Z(_,E,v),x=u,c=En(w,x-1,r,n,s,i,o,a,f,m,h,c,S,E,u,d,_,e,t[f],v+1);else if(S||typeof w=="object"&&w!==null&&r in w){if(S?c=w:c=w[r],h=u!==d?c:o?a?i(c,[...n,f,...s]):i(c):i,S){let T=Ae(Z(_,E,v),c,t[f]);e.push(T),m[E]=h}else if(w[r]!==h)if(h===void 0&&i!==void 0||kt(w,r)&&h===c)_=Z(_,E,v);else{_=Z(_,E,v);let T=Ae(Z(_,r,v+1),c,t[f]);e.push(T),w[r]=h}}}g=null}else{if(c=m[r],_=Z(_,r,v),h=u!==d?c:o?a?i(c,[...n,f,...s]):i(c):i,!(kt(m,r)&&h===c||h===void 0&&i!==void 0)){let I=Ae(_,c,t[f]);e.push(I),m[r]=h}m=m[r]}if(typeof m!="object")break}}}function xn(e,t){for(var r=-1,n=t.length,s=e;s!=null&&++r<n;)s=s[t[r]];return s}function En(e,t,r,n,s,i,o,a,l,d,f,u,m,h,c,y,g,S,w,b){if(t===0&&(m||typeof e=="object"&&e!==null&&r in e)){if(m?u=e:u=e[r],f=c!==y?u:o?a?i(u,[...n,l,...s]):i(u):i,m){let x=Ae(g,u,w);S.push(x),d[h]=f}else if(e[r]!==f){if(!(f===void 0&&i!==void 0||kt(e,r)&&f===u)){let x=Ae(Z(g,r,b+1),u,w);S.push(x),e[r]=f}}}for(let x in e)typeof e[x]=="object"&&(g=Z(g,x,b),En(e[x],t-1,r,n,s,i,o,a,l,d,f,u,m,h,c,y,g,S,w,b+1))}function mo(){return{parent:null,key:null,children:[],depth:0}}function Z(e,t,r){if(e.depth===r)return Z(e.parent,t,r);var n={parent:e,key:t,depth:r,children:[]};return e.children.push(n),n}function Ae(e,t,r){let n=e,s=[];do s.push(n.key),n=n.parent;while(n.parent!=null);return{path:s,value:t,target:r}}});var _n=O((Gf,On)=>{"use strict";var{groupRestore:go,nestedRestore:yo}=Dt();On.exports=wo;function wo(){return function(){if(this.restore){this.restore.state.secret=this.secret;return}let{secret:t,wcLen:r}=this,n=Object.keys(t),s=bo(t,n),i=r>0,o=i?{secret:t,groupRestore:go,nestedRestore:yo}:{secret:t};this.restore=Function("o",So(s,n,i)).bind(o),this.restore.state=o}}function bo(e,t){return t.map(r=>{let{circle:n,escPath:s,leadingBracket:i}=e[r],a=n?`o.${n} = secret[${s}].val`:`o${i?"":"."}${r} = secret[${s}].val`,l=`secret[${s}].val = undefined`;return`
      if (secret[${s}].val !== undefined) {
        try { ${a} } catch (e) {}
        ${l}
      }
    `}).join("")}function So(e,t,r){return`
    const secret = this.secret
    ${r===!0?`
    const keys = Object.keys(secret)
    const len = keys.length
    for (var i = len - 1; i >= ${t.length}; i--) {
      const k = keys[i]
      const o = secret[k]
      if (o) {
        if (o.flat === true) this.groupRestore(o)
        else this.nestedRestore(o)
        secret[k] = null
      }
    }
  `:""}
    ${e}
    return o
  `}});var In=O((Jf,Rn)=>{"use strict";Rn.exports=xo;function xo(e){let{secret:t,censor:r,compileRestore:n,serialize:s,groupRedact:i,nestedRedact:o,wildcards:a,wcLen:l}=e,d=[{secret:t,censor:r,compileRestore:n}];return s!==!1&&d.push({serialize:s}),l>0&&d.push({groupRedact:i,nestedRedact:o,wildcards:a,wcLen:l}),Object.assign(...d)}});var Cn=O((Hf,Tn)=>{"use strict";var An=mn(),Eo=wn(),vo=Sn(),Oo=_n(),{groupRedact:_o,nestedRedact:Ro}=Dt(),Io=In(),Ao=Xe(),To=An(),zt=e=>e;zt.restore=zt;var Co="[REDACTED]";Bt.rx=Ao;Bt.validator=An;Tn.exports=Bt;function Bt(e={}){let t=Array.from(new Set(e.paths||[])),r="serialize"in e&&(e.serialize===!1||typeof e.serialize=="function")?e.serialize:JSON.stringify,n=e.remove;if(n===!0&&r!==JSON.stringify)throw Error("fast-redact \u2013 remove option may only be set when serializer is JSON.stringify");let s=n===!0?void 0:"censor"in e?e.censor:Co,i=typeof s=="function",o=i&&s.length>1;if(t.length===0)return r||zt;To({paths:t,serialize:r,censor:s});let{wildcards:a,wcLen:l,secret:d}=Eo({paths:t,censor:s}),f=Oo(),u="strict"in e?e.strict:!0;return vo({secret:d,wcLen:l,serialize:r,strict:u,isCensorFct:i,censorFctTakesPath:o},Io({secret:d,censor:s,compileRestore:f,serialize:r,groupRedact:_o,nestedRedact:Ro,wildcards:a,wcLen:l}))}});var Se=O((Kf,Pn)=>{"use strict";var Po=Symbol("pino.setLevel"),Lo=Symbol("pino.getLevel"),No=Symbol("pino.levelVal"),Mo=Symbol("pino.levelComp"),$o=Symbol("pino.useLevelLabels"),jo=Symbol("pino.useOnlyCustomLevels"),ko=Symbol("pino.mixin"),Do=Symbol("pino.lsCache"),zo=Symbol("pino.chindings"),Bo=Symbol("pino.asJson"),qo=Symbol("pino.write"),Fo=Symbol("pino.redactFmt"),Vo=Symbol("pino.time"),Uo=Symbol("pino.timeSliceIndex"),Wo=Symbol("pino.stream"),Go=Symbol("pino.stringify"),Jo=Symbol("pino.stringifySafe"),Ho=Symbol("pino.stringifiers"),Ko=Symbol("pino.end"),Yo=Symbol("pino.formatOpts"),Xo=Symbol("pino.messageKey"),Zo=Symbol("pino.errorKey"),Qo=Symbol("pino.nestedKey"),ea=Symbol("pino.nestedKeyStr"),ta=Symbol("pino.mixinMergeStrategy"),ra=Symbol("pino.msgPrefix"),na=Symbol("pino.wildcardFirst"),sa=Symbol.for("pino.serializers"),ia=Symbol.for("pino.formatters"),oa=Symbol.for("pino.hooks"),aa=Symbol.for("pino.metadata");Pn.exports={setLevelSym:Po,getLevelSym:Lo,levelValSym:No,levelCompSym:Mo,useLevelLabelsSym:$o,mixinSym:ko,lsCacheSym:Do,chindingsSym:zo,asJsonSym:Bo,writeSym:qo,serializersSym:sa,redactFmtSym:Fo,timeSym:Vo,timeSliceIndexSym:Uo,streamSym:Wo,stringifySym:Go,stringifySafeSym:Jo,stringifiersSym:Ho,endSym:Ko,formatOptsSym:Yo,messageKeySym:Xo,errorKeySym:Zo,nestedKeySym:Qo,wildcardFirstSym:na,needsMetadataGsym:aa,useOnlyCustomLevelsSym:jo,formattersSym:ia,hooksSym:oa,nestedKeyStrSym:ea,mixinMergeStrategySym:ta,msgPrefixSym:ra}});var Vt=O((Yf,$n)=>{"use strict";var Ft=Cn(),{redactFmtSym:ca,wildcardFirstSym:Ze}=Se(),{rx:qt,validator:ua}=Ft,Ln=ua({ERR_PATHS_MUST_BE_STRINGS:()=>"pino \u2013 redacted paths must be strings",ERR_INVALID_PATH:e=>`pino \u2013 redact paths array contains an invalid path (${e})`}),Nn="[Redacted]",Mn=!1;function la(e,t){let{paths:r,censor:n}=fa(e),s=r.reduce((a,l)=>{qt.lastIndex=0;let d=qt.exec(l),f=qt.exec(l),u=d[1]!==void 0?d[1].replace(/^(?:"|'|`)(.*)(?:"|'|`)$/,"$1"):d[0];if(u==="*"&&(u=Ze),f===null)return a[u]=null,a;if(a[u]===null)return a;let{index:m}=f,h=`${l.substr(m,l.length-1)}`;return a[u]=a[u]||[],u!==Ze&&a[u].length===0&&a[u].push(...a[Ze]||[]),u===Ze&&Object.keys(a).forEach(function(c){a[c]&&a[c].push(h)}),a[u].push(h),a},{}),i={[ca]:Ft({paths:r,censor:n,serialize:t,strict:Mn})},o=(...a)=>t(typeof n=="function"?n(...a):n);return[...Object.keys(s),...Object.getOwnPropertySymbols(s)].reduce((a,l)=>{if(s[l]===null)a[l]=d=>o(d,[l]);else{let d=typeof n=="function"?(f,u)=>n(f,[l,...u]):n;a[l]=Ft({paths:s[l],censor:d,serialize:t,strict:Mn})}return a},i)}function fa(e){if(Array.isArray(e))return e={paths:e,censor:Nn},Ln(e),e;let{paths:t,censor:r=Nn,remove:n}=e;if(Array.isArray(t)===!1)throw Error("pino \u2013 redact must contain an array of strings");return n===!0&&(r=void 0),Ln({paths:t,censor:r}),{paths:t,censor:r}}$n.exports=la});var kn=O((Xf,jn)=>{"use strict";var da=()=>"",ha=()=>`,"time":${Date.now()}`,pa=()=>`,"time":${Math.round(Date.now()/1e3)}`,ma=()=>`,"time":"${new Date(Date.now()).toISOString()}"`;jn.exports={nullTime:da,epochTime:ha,unixTime:pa,isoTime:ma}});var zn=O((Zf,Dn)=>{"use strict";function ga(e){try{return JSON.stringify(e)}catch{return'"[Circular]"'}}Dn.exports=ya;function ya(e,t,r){var n=r&&r.stringify||ga,s=1;if(typeof e=="object"&&e!==null){var i=t.length+s;if(i===1)return e;var o=new Array(i);o[0]=n(e);for(var a=1;a<i;a++)o[a]=n(t[a]);return o.join(" ")}if(typeof e!="string")return e;var l=t.length;if(l===0)return e;for(var d="",f=1-s,u=-1,m=e&&e.length||0,h=0;h<m;){if(e.charCodeAt(h)===37&&h+1<m){switch(u=u>-1?u:0,e.charCodeAt(h+1)){case 100:case 102:if(f>=l||t[f]==null)break;u<h&&(d+=e.slice(u,h)),d+=Number(t[f]),u=h+2,h++;break;case 105:if(f>=l||t[f]==null)break;u<h&&(d+=e.slice(u,h)),d+=Math.floor(Number(t[f])),u=h+2,h++;break;case 79:case 111:case 106:if(f>=l||t[f]===void 0)break;u<h&&(d+=e.slice(u,h));var c=typeof t[f];if(c==="string"){d+="'"+t[f]+"'",u=h+2,h++;break}if(c==="function"){d+=t[f].name||"<anonymous>",u=h+2,h++;break}d+=n(t[f]),u=h+2,h++;break;case 115:if(f>=l)break;u<h&&(d+=e.slice(u,h)),d+=String(t[f]),u=h+2,h++;break;case 37:u<h&&(d+=e.slice(u,h)),d+="%",u=h+2,h++,f--;break}++f}++h}return u===-1?e:(u<m&&(d+=e.slice(u)),d)}});var Wt=O((Qf,Ut)=>{"use strict";if(typeof SharedArrayBuffer<"u"&&typeof Atomics<"u"){let t=function(r){if((r>0&&r<1/0)===!1)throw typeof r!="number"&&typeof r!="bigint"?TypeError("sleep: ms must be a number"):RangeError("sleep: ms must be a number that is greater than 0 but less than Infinity");Atomics.wait(e,0,0,Number(r))},e=new Int32Array(new SharedArrayBuffer(4));Ut.exports=t}else{let e=function(t){if((t>0&&t<1/0)===!1)throw typeof t!="number"&&typeof t!="bigint"?TypeError("sleep: ms must be a number"):RangeError("sleep: ms must be a number that is greater than 0 but less than Infinity");let n=Date.now()+Number(t);for(;n>Date.now(););};Ut.exports=e}});var Jn=O((ed,Gn)=>{"use strict";var C=N("node:fs"),wa=N("node:events"),ba=N("node:util").inherits,Bn=N("node:path"),Jt=Wt(),Sa=N("node:assert"),Qe=100,et=Buffer.allocUnsafe(0),xa=16*1024,qn="buffer",Fn="utf8",[Ea,va]=(process.versions.node||"0.0").split(".").map(Number),Oa=Ea>=22&&va>=7;function Vn(e,t){t._opening=!0,t._writing=!0,t._asyncDrainScheduled=!1;function r(i,o){if(i){t._reopening=!1,t._writing=!1,t._opening=!1,t.sync?process.nextTick(()=>{t.listenerCount("error")>0&&t.emit("error",i)}):t.emit("error",i);return}let a=t._reopening;t.fd=o,t.file=e,t._reopening=!1,t._opening=!1,t._writing=!1,t.sync?process.nextTick(()=>t.emit("ready")):t.emit("ready"),!t.destroyed&&(!t._writing&&t._len>t.minLength||t._flushPending?t._actualWrite():a&&process.nextTick(()=>t.emit("drain")))}let n=t.append?"a":"w",s=t.mode;if(t.sync)try{t.mkdir&&C.mkdirSync(Bn.dirname(e),{recursive:!0});let i=C.openSync(e,n,s);r(null,i)}catch(i){throw r(i),i}else t.mkdir?C.mkdir(Bn.dirname(e),{recursive:!0},i=>{if(i)return r(i);C.open(e,n,s,r)}):C.open(e,n,s,r)}function q(e){if(!(this instanceof q))return new q(e);let{fd:t,dest:r,minLength:n,maxLength:s,maxWrite:i,periodicFlush:o,sync:a,append:l=!0,mkdir:d,retryEAGAIN:f,fsync:u,contentMode:m,mode:h}=e||{};t=t||r,this._len=0,this.fd=-1,this._bufs=[],this._lens=[],this._writing=!1,this._ending=!1,this._reopening=!1,this._asyncDrainScheduled=!1,this._flushPending=!1,this._hwm=Math.max(n||0,16387),this.file=null,this.destroyed=!1,this.minLength=n||0,this.maxLength=s||0,this.maxWrite=i||xa,this._periodicFlush=o||0,this._periodicFlushTimer=void 0,this.sync=a||!1,this.writable=!0,this._fsync=u||!1,this.append=l||!1,this.mode=h,this.retryEAGAIN=f||(()=>!0),this.mkdir=d||!1;let c,y;if(m===qn)this._writingBuf=et,this.write=Ia,this.flush=Ta,this.flushSync=Pa,this._actualWrite=Na,c=()=>C.writeSync(this.fd,this._writingBuf),y=()=>C.write(this.fd,this._writingBuf,this.release);else if(m===void 0||m===Fn)this._writingBuf="",this.write=Ra,this.flush=Aa,this.flushSync=Ca,this._actualWrite=La,c=()=>C.writeSync(this.fd,this._writingBuf,"utf8"),y=()=>C.write(this.fd,this._writingBuf,"utf8",this.release);else throw new Error(`SonicBoom supports "${Fn}" and "${qn}", but passed ${m}`);if(typeof t=="number")this.fd=t,process.nextTick(()=>this.emit("ready"));else if(typeof t=="string")Vn(t,this);else throw new Error("SonicBoom supports only file descriptors and files");if(this.minLength>=this.maxWrite)throw new Error(`minLength should be smaller than maxWrite (${this.maxWrite})`);this.release=(g,S)=>{if(g){if((g.code==="EAGAIN"||g.code==="EBUSY")&&this.retryEAGAIN(g,this._writingBuf.length,this._len-this._writingBuf.length))if(this.sync)try{Jt(Qe),this.release(void 0,0)}catch(x){this.release(x)}else setTimeout(y,Qe);else this._writing=!1,this.emit("error",g);return}this.emit("write",S);let w=Gt(this._writingBuf,this._len,S);if(this._len=w.len,this._writingBuf=w.writingBuf,this._writingBuf.length){if(!this.sync){y();return}try{do{let x=c(),v=Gt(this._writingBuf,this._len,x);this._len=v.len,this._writingBuf=v.writingBuf}while(this._writingBuf.length)}catch(x){this.release(x);return}}this._fsync&&C.fsyncSync(this.fd);let b=this._len;this._reopening?(this._writing=!1,this._reopening=!1,this.reopen()):b>this.minLength?this._actualWrite():this._ending?b>0?this._actualWrite():(this._writing=!1,tt(this)):(this._writing=!1,this.sync?this._asyncDrainScheduled||(this._asyncDrainScheduled=!0,process.nextTick(_a,this)):this.emit("drain"))},this.on("newListener",function(g){g==="drain"&&(this._asyncDrainScheduled=!1)}),this._periodicFlush!==0&&(this._periodicFlushTimer=setInterval(()=>this.flush(null),this._periodicFlush),this._periodicFlushTimer.unref())}function Gt(e,t,r){return typeof e=="string"&&Buffer.byteLength(e)!==r&&(r=Buffer.from(e).subarray(0,r).toString().length),t=Math.max(t-r,0),e=e.slice(r),{writingBuf:e,len:t}}function _a(e){e.listenerCount("drain")>0&&(e._asyncDrainScheduled=!1,e.emit("drain"))}ba(q,wa);function Un(e,t){return e.length===0?et:e.length===1?e[0]:Buffer.concat(e,t)}function Ra(e){if(this.destroyed)throw new Error("SonicBoom destroyed");let t=this._len+e.length,r=this._bufs;return this.maxLength&&t>this.maxLength?(this.emit("drop",e),this._len<this._hwm):(r.length===0||r[r.length-1].length+e.length>this.maxWrite?r.push(""+e):r[r.length-1]+=e,this._len=t,!this._writing&&this._len>=this.minLength&&this._actualWrite(),this._len<this._hwm)}function Ia(e){if(this.destroyed)throw new Error("SonicBoom destroyed");let t=this._len+e.length,r=this._bufs,n=this._lens;return this.maxLength&&t>this.maxLength?(this.emit("drop",e),this._len<this._hwm):(r.length===0||n[n.length-1]+e.length>this.maxWrite?(r.push([e]),n.push(e.length)):(r[r.length-1].push(e),n[n.length-1]+=e.length),this._len=t,!this._writing&&this._len>=this.minLength&&this._actualWrite(),this._len<this._hwm)}function Wn(e){this._flushPending=!0;let t=()=>{if(this._fsync)this._flushPending=!1,e();else try{C.fsync(this.fd,n=>{this._flushPending=!1,e(n)})}catch(n){e(n)}this.off("error",r)},r=n=>{this._flushPending=!1,e(n),this.off("drain",t)};this.once("drain",t),this.once("error",r)}function Aa(e){if(e!=null&&typeof e!="function")throw new Error("flush cb must be a function");if(this.destroyed){let t=new Error("SonicBoom destroyed");if(e){e(t);return}throw t}if(this.minLength<=0){e?.();return}e&&Wn.call(this,e),!this._writing&&(this._bufs.length===0&&this._bufs.push(""),this._actualWrite())}function Ta(e){if(e!=null&&typeof e!="function")throw new Error("flush cb must be a function");if(this.destroyed){let t=new Error("SonicBoom destroyed");if(e){e(t);return}throw t}if(this.minLength<=0){e?.();return}e&&Wn.call(this,e),!this._writing&&(this._bufs.length===0&&(this._bufs.push([]),this._lens.push(0)),this._actualWrite())}q.prototype.reopen=function(e){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this._opening){this.once("ready",()=>{this.reopen(e)});return}if(this._ending)return;if(!this.file)throw new Error("Unable to reopen a file descriptor, you must pass a file to SonicBoom");if(e&&(this.file=e),this._reopening=!0,this._writing)return;let t=this.fd;this.once("ready",()=>{t!==this.fd&&C.close(t,r=>{if(r)return this.emit("error",r)})}),Vn(this.file,this)};q.prototype.end=function(){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this._opening){this.once("ready",()=>{this.end()});return}this._ending||(this._ending=!0,!this._writing&&(this._len>0&&this.fd>=0?this._actualWrite():tt(this)))};function Ca(){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this.fd<0)throw new Error("sonic boom is not ready yet");!this._writing&&this._writingBuf.length>0&&(this._bufs.unshift(this._writingBuf),this._writingBuf="");let e="";for(;this._bufs.length||e;){e.length<=0&&(e=this._bufs[0]);try{let t=C.writeSync(this.fd,e,"utf8"),r=Gt(e,this._len,t);e=r.writingBuf,this._len=r.len,e.length<=0&&this._bufs.shift()}catch(t){if((t.code==="EAGAIN"||t.code==="EBUSY")&&!this.retryEAGAIN(t,e.length,this._len-e.length))throw t;Jt(Qe)}}try{C.fsyncSync(this.fd)}catch{}}function Pa(){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this.fd<0)throw new Error("sonic boom is not ready yet");!this._writing&&this._writingBuf.length>0&&(this._bufs.unshift([this._writingBuf]),this._writingBuf=et);let e=et;for(;this._bufs.length||e.length;){e.length<=0&&(e=Un(this._bufs[0],this._lens[0]));try{let t=C.writeSync(this.fd,e);e=e.subarray(t),this._len=Math.max(this._len-t,0),e.length<=0&&(this._bufs.shift(),this._lens.shift())}catch(t){if((t.code==="EAGAIN"||t.code==="EBUSY")&&!this.retryEAGAIN(t,e.length,this._len-e.length))throw t;Jt(Qe)}}}q.prototype.destroy=function(){this.destroyed||tt(this)};function La(){let e=this.release;if(this._writing=!0,this._writingBuf=this._writingBuf||this._bufs.shift()||"",this.sync)try{let t=C.writeSync(this.fd,this._writingBuf,"utf8");e(null,t)}catch(t){e(t)}else C.write(this.fd,this._writingBuf,"utf8",e)}function Na(){let e=this.release;if(this._writing=!0,this._writingBuf=this._writingBuf.length?this._writingBuf:Un(this._bufs.shift(),this._lens.shift()),this.sync)try{let t=C.writeSync(this.fd,this._writingBuf);e(null,t)}catch(t){e(t)}else Oa&&(this._writingBuf=Buffer.from(this._writingBuf)),C.write(this.fd,this._writingBuf,e)}function tt(e){if(e.fd===-1){e.once("ready",tt.bind(null,e));return}e._periodicFlushTimer!==void 0&&clearInterval(e._periodicFlushTimer),e.destroyed=!0,e._bufs=[],e._lens=[],Sa(typeof e.fd=="number",`sonic.fd must be a number, got ${typeof e.fd}`);try{C.fsync(e.fd,t)}catch{}function t(){e.fd!==1&&e.fd!==2?C.close(e.fd,r):r()}function r(n){if(n){e.emit("error",n);return}e._ending&&!e._writing&&e.emit("finish"),e.emit("close")}}q.SonicBoom=q;q.default=q;Gn.exports=q});var Ht=O((td,Zn)=>{"use strict";var F={exit:[],beforeExit:[]},Hn={exit:ja,beforeExit:ka},xe;function Ma(){xe===void 0&&(xe=new FinalizationRegistry(Da))}function $a(e){F[e].length>0||process.on(e,Hn[e])}function Kn(e){F[e].length>0||(process.removeListener(e,Hn[e]),F.exit.length===0&&F.beforeExit.length===0&&(xe=void 0))}function ja(){Yn("exit")}function ka(){Yn("beforeExit")}function Yn(e){for(let t of F[e]){let r=t.deref(),n=t.fn;r!==void 0&&n(r,e)}F[e]=[]}function Da(e){for(let t of["exit","beforeExit"]){let r=F[t].indexOf(e);F[t].splice(r,r+1),Kn(t)}}function Xn(e,t,r){if(t===void 0)throw new Error("the object can't be undefined");$a(e);let n=new WeakRef(t);n.fn=r,Ma(),xe.register(t,n),F[e].push(n)}function za(e,t){Xn("exit",e,t)}function Ba(e,t){Xn("beforeExit",e,t)}function qa(e){if(xe!==void 0){xe.unregister(e);for(let t of["exit","beforeExit"])F[t]=F[t].filter(r=>{let n=r.deref();return n&&n!==e}),Kn(t)}}Zn.exports={register:za,registerBeforeExit:Ba,unregister:qa}});var Qn=O((rd,Fa)=>{Fa.exports={name:"thread-stream",version:"3.1.0",description:"A streaming way to send data to a Node.js Worker Thread",main:"index.js",types:"index.d.ts",dependencies:{"real-require":"^0.2.0"},devDependencies:{"@types/node":"^20.1.0","@types/tap":"^15.0.0","@yao-pkg/pkg":"^5.11.5",desm:"^1.3.0",fastbench:"^1.0.1",husky:"^9.0.6","pino-elasticsearch":"^8.0.0","sonic-boom":"^4.0.1",standard:"^17.0.0",tap:"^16.2.0","ts-node":"^10.8.0",typescript:"^5.3.2","why-is-node-running":"^2.2.2"},scripts:{build:"tsc --noEmit",test:'standard && npm run build && npm run transpile && tap "test/**/*.test.*js" && tap --ts test/*.test.*ts',"test:ci":"standard && npm run transpile && npm run test:ci:js && npm run test:ci:ts","test:ci:js":'tap --no-check-coverage --timeout=120 --coverage-report=lcovonly "test/**/*.test.*js"',"test:ci:ts":'tap --ts --no-check-coverage --coverage-report=lcovonly "test/**/*.test.*ts"',"test:yarn":'npm run transpile && tap "test/**/*.test.js" --no-check-coverage',transpile:"sh ./test/ts/transpile.sh",prepare:"husky install"},standard:{ignore:["test/ts/**/*","test/syntax-error.mjs"]},repository:{type:"git",url:"git+https://github.com/mcollina/thread-stream.git"},keywords:["worker","thread","threads","stream"],author:"Matteo Collina <hello@matteocollina.com>",license:"MIT",bugs:{url:"https://github.com/mcollina/thread-stream/issues"},homepage:"https://github.com/mcollina/thread-stream#readme"}});var ts=O((nd,es)=>{"use strict";function Va(e,t,r,n,s){let i=Date.now()+n,o=Atomics.load(e,t);if(o===r){s(null,"ok");return}let a=o,l=d=>{Date.now()>i?s(null,"timed-out"):setTimeout(()=>{a=o,o=Atomics.load(e,t),o===a?l(d>=1e3?1e3:d*2):o===r?s(null,"ok"):s(null,"not-equal")},d)};l(1)}function Ua(e,t,r,n,s){let i=Date.now()+n,o=Atomics.load(e,t);if(o!==r){s(null,"ok");return}let a=l=>{Date.now()>i?s(null,"timed-out"):setTimeout(()=>{o=Atomics.load(e,t),o!==r?s(null,"ok"):a(l>=1e3?1e3:l*2)},l)};a(1)}es.exports={wait:Va,waitDiff:Ua}});var ns=O((sd,rs)=>{"use strict";rs.exports={WRITE_INDEX:4,READ_INDEX:8}});var cs=O((id,as)=>{"use strict";var{version:Wa}=Qn(),{EventEmitter:Ga}=N("node:events"),{Worker:Ja}=N("node:worker_threads"),{join:Ha}=N("node:path"),{pathToFileURL:Ka}=N("node:url"),{wait:Ya}=ts(),{WRITE_INDEX:$,READ_INDEX:H}=ns(),Xa=N("node:buffer"),Za=N("node:assert"),p=Symbol("kImpl"),Qa=Xa.constants.MAX_STRING_LENGTH,Te=class{constructor(t){this._value=t}deref(){return this._value}},nt=class{register(){}unregister(){}},ec=process.env.NODE_V8_COVERAGE?nt:global.FinalizationRegistry||nt,tc=process.env.NODE_V8_COVERAGE?Te:global.WeakRef||Te,ss=new ec(e=>{e.exited||e.terminate()});function rc(e,t){let{filename:r,workerData:n}=t,i=("__bundlerPathsOverrides"in globalThis?globalThis.__bundlerPathsOverrides:{})["thread-stream-worker"]||Ha(__dirname,"lib","worker.js"),o=new Ja(i,{...t.workerOpts,trackUnmanagedFds:!1,workerData:{filename:r.indexOf("file://")===0?r:Ka(r).href,dataBuf:e[p].dataBuf,stateBuf:e[p].stateBuf,workerData:{$context:{threadStreamVersion:Wa},...n}}});return o.stream=new Te(e),o.on("message",nc),o.on("exit",os),ss.register(e,o),o}function is(e){Za(!e[p].sync),e[p].needDrain&&(e[p].needDrain=!1,e.emit("drain"))}function rt(e){let t=Atomics.load(e[p].state,$),r=e[p].data.length-t;if(r>0){if(e[p].buf.length===0){e[p].flushing=!1,e[p].ending?Qt(e):e[p].needDrain&&process.nextTick(is,e);return}let n=e[p].buf.slice(0,r),s=Buffer.byteLength(n);s<=r?(e[p].buf=e[p].buf.slice(r),st(e,n,rt.bind(null,e))):e.flush(()=>{if(!e.destroyed){for(Atomics.store(e[p].state,H,0),Atomics.store(e[p].state,$,0);s>e[p].data.length;)r=r/2,n=e[p].buf.slice(0,r),s=Buffer.byteLength(n);e[p].buf=e[p].buf.slice(r),st(e,n,rt.bind(null,e))}})}else if(r===0){if(t===0&&e[p].buf.length===0)return;e.flush(()=>{Atomics.store(e[p].state,H,0),Atomics.store(e[p].state,$,0),rt(e)})}else K(e,new Error("overwritten"))}function nc(e){let t=this.stream.deref();if(t===void 0){this.exited=!0,this.terminate();return}switch(e.code){case"READY":this.stream=new tc(t),t.flush(()=>{t[p].ready=!0,t.emit("ready")});break;case"ERROR":K(t,e.err);break;case"EVENT":Array.isArray(e.args)?t.emit(e.name,...e.args):t.emit(e.name,e.args);break;case"WARNING":process.emitWarning(e.err);break;default:K(t,new Error("this should not happen: "+e.code))}}function os(e){let t=this.stream.deref();t!==void 0&&(ss.unregister(t),t.worker.exited=!0,t.worker.off("exit",os),K(t,e!==0?new Error("the worker thread exited"):null))}var Yt=class extends Ga{constructor(t={}){if(super(),t.bufferSize<4)throw new Error("bufferSize must at least fit a 4-byte utf-8 char");this[p]={},this[p].stateBuf=new SharedArrayBuffer(128),this[p].state=new Int32Array(this[p].stateBuf),this[p].dataBuf=new SharedArrayBuffer(t.bufferSize||4*1024*1024),this[p].data=Buffer.from(this[p].dataBuf),this[p].sync=t.sync||!1,this[p].ending=!1,this[p].ended=!1,this[p].needDrain=!1,this[p].destroyed=!1,this[p].flushing=!1,this[p].ready=!1,this[p].finished=!1,this[p].errored=null,this[p].closed=!1,this[p].buf="",this.worker=rc(this,t),this.on("message",(r,n)=>{this.worker.postMessage(r,n)})}write(t){if(this[p].destroyed)return Xt(this,new Error("the worker has exited")),!1;if(this[p].ending)return Xt(this,new Error("the worker is ending")),!1;if(this[p].flushing&&this[p].buf.length+t.length>=Qa)try{Kt(this),this[p].flushing=!0}catch(r){return K(this,r),!1}if(this[p].buf+=t,this[p].sync)try{return Kt(this),!0}catch(r){return K(this,r),!1}return this[p].flushing||(this[p].flushing=!0,setImmediate(rt,this)),this[p].needDrain=this[p].data.length-this[p].buf.length-Atomics.load(this[p].state,$)<=0,!this[p].needDrain}end(){this[p].destroyed||(this[p].ending=!0,Qt(this))}flush(t){if(this[p].destroyed){typeof t=="function"&&process.nextTick(t,new Error("the worker has exited"));return}let r=Atomics.load(this[p].state,$);Ya(this[p].state,H,r,1/0,(n,s)=>{if(n){K(this,n),process.nextTick(t,n);return}if(s==="not-equal"){this.flush(t);return}process.nextTick(t)})}flushSync(){this[p].destroyed||(Kt(this),Zt(this))}unref(){this.worker.unref()}ref(){this.worker.ref()}get ready(){return this[p].ready}get destroyed(){return this[p].destroyed}get closed(){return this[p].closed}get writable(){return!this[p].destroyed&&!this[p].ending}get writableEnded(){return this[p].ending}get writableFinished(){return this[p].finished}get writableNeedDrain(){return this[p].needDrain}get writableObjectMode(){return!1}get writableErrored(){return this[p].errored}};function Xt(e,t){setImmediate(()=>{e.emit("error",t)})}function K(e,t){e[p].destroyed||(e[p].destroyed=!0,t&&(e[p].errored=t,Xt(e,t)),e.worker.exited?setImmediate(()=>{e[p].closed=!0,e.emit("close")}):e.worker.terminate().catch(()=>{}).then(()=>{e[p].closed=!0,e.emit("close")}))}function st(e,t,r){let n=Atomics.load(e[p].state,$),s=Buffer.byteLength(t);return e[p].data.write(t,n),Atomics.store(e[p].state,$,n+s),Atomics.notify(e[p].state,$),r(),!0}function Qt(e){if(!(e[p].ended||!e[p].ending||e[p].flushing)){e[p].ended=!0;try{e.flushSync();let t=Atomics.load(e[p].state,H);Atomics.store(e[p].state,$,-1),Atomics.notify(e[p].state,$);let r=0;for(;t!==-1;){if(Atomics.wait(e[p].state,H,t,1e3),t=Atomics.load(e[p].state,H),t===-2){K(e,new Error("end() failed"));return}if(++r===10){K(e,new Error("end() took too long (10s)"));return}}process.nextTick(()=>{e[p].finished=!0,e.emit("finish")})}catch(t){K(e,t)}}}function Kt(e){let t=()=>{e[p].ending?Qt(e):e[p].needDrain&&process.nextTick(is,e)};for(e[p].flushing=!1;e[p].buf.length!==0;){let r=Atomics.load(e[p].state,$),n=e[p].data.length-r;if(n===0){Zt(e),Atomics.store(e[p].state,H,0),Atomics.store(e[p].state,$,0);continue}else if(n<0)throw new Error("overwritten");let s=e[p].buf.slice(0,n),i=Buffer.byteLength(s);if(i<=n)e[p].buf=e[p].buf.slice(n),st(e,s,t);else{for(Zt(e),Atomics.store(e[p].state,H,0),Atomics.store(e[p].state,$,0);i>e[p].buf.length;)n=n/2,s=e[p].buf.slice(0,n),i=Buffer.byteLength(s);e[p].buf=e[p].buf.slice(n),st(e,s,t)}}}function Zt(e){if(e[p].flushing)throw new Error("unable to flush while flushing");let t=Atomics.load(e[p].state,$),r=0;for(;;){let n=Atomics.load(e[p].state,H);if(n===-2)throw Error("_flushSync failed");if(n!==t)Atomics.wait(e[p].state,H,n,1e3);else break;if(++r===10)throw new Error("_flushSync took too long (10s)")}}as.exports=Yt});var rr=O((od,us)=>{"use strict";var{createRequire:sc}=N("node:module"),ic=jt(),{join:er,isAbsolute:oc,sep:ac}=N("node:path"),cc=Wt(),tr=Ht(),uc=cs();function lc(e){tr.register(e,dc),tr.registerBeforeExit(e,hc),e.on("close",function(){tr.unregister(e)})}function fc(e,t,r,n){let s=new uc({filename:e,workerData:t,workerOpts:r,sync:n});s.on("ready",i),s.on("close",function(){process.removeListener("exit",o)}),process.on("exit",o);function i(){process.removeListener("exit",o),s.unref(),r.autoEnd!==!1&&lc(s)}function o(){s.closed||(s.flushSync(),cc(100),s.end())}return s}function dc(e){e.ref(),e.flushSync(),e.end(),e.once("close",function(){e.unref()})}function hc(e){e.flushSync()}function pc(e){let{pipeline:t,targets:r,levels:n,dedupe:s,worker:i={},caller:o=ic(),sync:a=!1}=e,l={...e.options},d=typeof o=="string"?[o]:o,f="__bundlerPathsOverrides"in globalThis?globalThis.__bundlerPathsOverrides:{},u=e.target;if(u&&r)throw new Error("only one of target or targets can be specified");return r?(u=f["pino-worker"]||er(__dirname,"worker.js"),l.targets=r.filter(h=>h.target).map(h=>({...h,target:m(h.target)})),l.pipelines=r.filter(h=>h.pipeline).map(h=>h.pipeline.map(c=>({...c,level:h.level,target:m(c.target)})))):t&&(u=f["pino-worker"]||er(__dirname,"worker.js"),l.pipelines=[t.map(h=>({...h,target:m(h.target)}))]),n&&(l.levels=n),s&&(l.dedupe=s),l.pinoWillSendConfig=!0,fc(m(u),l,i,a);function m(h){if(h=f[h]||h,oc(h)||h.indexOf("file://")===0)return h;if(h==="pino/file")return er(__dirname,"..","file.js");let c;for(let y of d)try{let g=y==="node:repl"?process.cwd()+ac:y;c=sc(g).resolve(h);break}catch{continue}if(!c)throw new Error(`unable to determine transport target for "${h}"`);return c}}us.exports=pc});var at=O((ad,Ss)=>{"use strict";var ls=zn(),{mapHttpRequest:mc,mapHttpResponse:gc}=$t(),sr=Jn(),fs=Ht(),{lsCacheSym:yc,chindingsSym:ps,writeSym:ds,serializersSym:ms,formatOptsSym:hs,endSym:wc,stringifiersSym:gs,stringifySym:ys,stringifySafeSym:ir,wildcardFirstSym:ws,nestedKeySym:bc,formattersSym:bs,messageKeySym:Sc,errorKeySym:xc,nestedKeyStrSym:Ec,msgPrefixSym:it}=Se(),{isMainThread:vc}=N("node:worker_threads"),Oc=rr();function Ee(){}function _c(e,t){if(!t)return r;return function(...s){t.call(this,s,r,e)};function r(n,...s){if(typeof n=="object"){let i=n;n!==null&&(n.method&&n.headers&&n.socket?n=mc(n):typeof n.setHeader=="function"&&(n=gc(n)));let o;i===null&&s.length===0?o=[null]:(i=s.shift(),o=s),typeof this[it]=="string"&&i!==void 0&&i!==null&&(i=this[it]+i),this[ds](n,ls(i,o,this[hs]),e)}else{let i=n===void 0?s.shift():n;typeof this[it]=="string"&&i!==void 0&&i!==null&&(i=this[it]+i),this[ds](null,ls(i,s,this[hs]),e)}}}function nr(e){let t="",r=0,n=!1,s=255,i=e.length;if(i>100)return JSON.stringify(e);for(var o=0;o<i&&s>=32;o++)s=e.charCodeAt(o),(s===34||s===92)&&(t+=e.slice(r,o)+"\\",r=o,n=!0);return n?t+=e.slice(r):t=e,s<32?JSON.stringify(e):'"'+t+'"'}function Rc(e,t,r,n){let s=this[ys],i=this[ir],o=this[gs],a=this[wc],l=this[ps],d=this[ms],f=this[bs],u=this[Sc],m=this[xc],h=this[yc][r]+n;h=h+l;let c;f.log&&(e=f.log(e));let y=o[ws],g="";for(let w in e)if(c=e[w],Object.prototype.hasOwnProperty.call(e,w)&&c!==void 0){d[w]?c=d[w](c):w===m&&d.err&&(c=d.err(c));let b=o[w]||y;switch(typeof c){case"undefined":case"function":continue;case"number":Number.isFinite(c)===!1&&(c=null);case"boolean":b&&(c=b(c));break;case"string":c=(b||nr)(c);break;default:c=(b||s)(c,i)}if(c===void 0)continue;let x=nr(w);g+=","+x+":"+c}let S="";if(t!==void 0){c=d[u]?d[u](t):t;let w=o[u]||y;switch(typeof c){case"function":break;case"number":Number.isFinite(c)===!1&&(c=null);case"boolean":w&&(c=w(c)),S=',"'+u+'":'+c;break;case"string":c=(w||nr)(c),S=',"'+u+'":'+c;break;default:c=(w||s)(c,i),S=',"'+u+'":'+c}}return this[bc]&&g?h+this[Ec]+g.slice(1)+"}"+S+a:h+g+S+a}function Ic(e,t){let r,n=e[ps],s=e[ys],i=e[ir],o=e[gs],a=o[ws],l=e[ms],d=e[bs].bindings;t=d(t);for(let f in t)if(r=t[f],(f!=="level"&&f!=="serializers"&&f!=="formatters"&&f!=="customLevels"&&t.hasOwnProperty(f)&&r!==void 0)===!0){if(r=l[f]?l[f](r):r,r=(o[f]||a||s)(r,i),r===void 0)continue;n+=',"'+f+'":'+r}return n}function Ac(e){return e.write!==e.constructor.prototype.write}function ot(e){let t=new sr(e);return t.on("error",r),!e.sync&&vc&&(fs.register(t,Tc),t.on("close",function(){fs.unregister(t)})),t;function r(n){if(n.code==="EPIPE"){t.write=Ee,t.end=Ee,t.flushSync=Ee,t.destroy=Ee;return}t.removeListener("error",r),t.emit("error",n)}}function Tc(e,t){e.destroyed||(t==="beforeExit"?(e.flush(),e.on("drain",function(){e.end()})):e.flushSync())}function Cc(e){return function(r,n,s={},i){if(typeof s=="string")i=ot({dest:s}),s={};else if(typeof i=="string"){if(s&&s.transport)throw Error("only one of option.transport or stream can be specified");i=ot({dest:i})}else if(s instanceof sr||s.writable||s._writableState)i=s,s={};else if(s.transport){if(s.transport instanceof sr||s.transport.writable||s.transport._writableState)throw Error("option.transport do not allow stream, please pass to option directly. e.g. pino(transport)");if(s.transport.targets&&s.transport.targets.length&&s.formatters&&typeof s.formatters.level=="function")throw Error("option.transport.targets do not allow custom level formatters");let l;s.customLevels&&(l=s.useOnlyCustomLevels?s.customLevels:Object.assign({},s.levels,s.customLevels)),i=Oc({caller:n,...s.transport,levels:l})}if(s=Object.assign({},e,s),s.serializers=Object.assign({},e.serializers,s.serializers),s.formatters=Object.assign({},e.formatters,s.formatters),s.prettyPrint)throw new Error("prettyPrint option is no longer supported, see the pino-pretty package (https://github.com/pinojs/pino-pretty)");let{enabled:o,onChild:a}=s;return o===!1&&(s.level="silent"),a||(s.onChild=Ee),i||(Ac(process.stdout)?i=process.stdout:i=ot({fd:process.stdout.fd||1})),{opts:s,stream:i}}}function Pc(e,t){try{return JSON.stringify(e)}catch{try{return(t||this[ir])(e)}catch{return'"[unable to serialize, circular reference is too complex to analyze]"'}}}function Lc(e,t,r){return{level:e,bindings:t,log:r}}function Nc(e){let t=Number(e);return typeof e=="string"&&Number.isFinite(t)?t:e===void 0?1:e}Ss.exports={noop:Ee,buildSafeSonicBoom:ot,asChindings:Ic,asJson:Rc,genLog:_c,createArgsNormalizer:Cc,stringify:Pc,buildFormatters:Lc,normalizeDestFileDescriptor:Nc}});var ct=O((cd,xs)=>{var Mc={trace:10,debug:20,info:30,warn:40,error:50,fatal:60},$c={ASC:"ASC",DESC:"DESC"};xs.exports={DEFAULT_LEVELS:Mc,SORTING_ORDER:$c}});var cr=O((ud,_s)=>{"use strict";var{lsCacheSym:jc,levelValSym:or,useOnlyCustomLevelsSym:kc,streamSym:Dc,formattersSym:zc,hooksSym:Bc,levelCompSym:Es}=Se(),{noop:qc,genLog:ae}=at(),{DEFAULT_LEVELS:Y,SORTING_ORDER:vs}=ct(),Os={fatal:e=>{let t=ae(Y.fatal,e);return function(...r){let n=this[Dc];if(t.call(this,...r),typeof n.flushSync=="function")try{n.flushSync()}catch{}}},error:e=>ae(Y.error,e),warn:e=>ae(Y.warn,e),info:e=>ae(Y.info,e),debug:e=>ae(Y.debug,e),trace:e=>ae(Y.trace,e)},ar=Object.keys(Y).reduce((e,t)=>(e[Y[t]]=t,e),{}),Fc=Object.keys(ar).reduce((e,t)=>(e[t]='{"level":'+Number(t),e),{});function Vc(e){let t=e[zc].level,{labels:r}=e.levels,n={};for(let s in r){let i=t(r[s],Number(s));n[s]=JSON.stringify(i).slice(0,-1)}return e[jc]=n,e}function Uc(e,t){if(t)return!1;switch(e){case"fatal":case"error":case"warn":case"info":case"debug":case"trace":return!0;default:return!1}}function Wc(e){let{labels:t,values:r}=this.levels;if(typeof e=="number"){if(t[e]===void 0)throw Error("unknown level value"+e);e=t[e]}if(r[e]===void 0)throw Error("unknown level "+e);let n=this[or],s=this[or]=r[e],i=this[kc],o=this[Es],a=this[Bc].logMethod;for(let l in r){if(o(r[l],s)===!1){this[l]=qc;continue}this[l]=Uc(l,i)?Os[l](a):ae(r[l],a)}this.emit("level-change",e,s,t[n],n,this)}function Gc(e){let{levels:t,levelVal:r}=this;return t&&t.labels?t.labels[r]:""}function Jc(e){let{values:t}=this.levels,r=t[e];return r!==void 0&&this[Es](r,this[or])}function Hc(e,t,r){return e===vs.DESC?t<=r:t>=r}function Kc(e){return typeof e=="string"?Hc.bind(null,e):e}function Yc(e=null,t=!1){let r=e?Object.keys(e).reduce((i,o)=>(i[e[o]]=o,i),{}):null,n=Object.assign(Object.create(Object.prototype,{Infinity:{value:"silent"}}),t?null:ar,r),s=Object.assign(Object.create(Object.prototype,{silent:{value:1/0}}),t?null:Y,e);return{labels:n,values:s}}function Xc(e,t,r){if(typeof e=="number"){if(![].concat(Object.keys(t||{}).map(i=>t[i]),r?[]:Object.keys(ar).map(i=>+i),1/0).includes(e))throw Error(`default level:${e} must be included in custom levels`);return}let n=Object.assign(Object.create(Object.prototype,{silent:{value:1/0}}),r?null:Y,t);if(!(e in n))throw Error(`default level:${e} must be included in custom levels`)}function Zc(e,t){let{labels:r,values:n}=e;for(let s in t){if(s in n)throw Error("levels cannot be overridden");if(t[s]in r)throw Error("pre-existing level values cannot be used for new levels")}}function Qc(e){if(typeof e!="function"&&!(typeof e=="string"&&Object.values(vs).includes(e)))throw new Error('Levels comparison should be one of "ASC", "DESC" or "function" type')}_s.exports={initialLsCache:Fc,genLsCache:Vc,levelMethods:Os,getLevel:Gc,setLevel:Wc,isLevelEnabled:Jc,mappings:Yc,assertNoLevelCollisions:Zc,assertDefaultLevelFound:Xc,genLevelComparison:Kc,assertLevelComparison:Qc}});var ur=O((ld,Rs)=>{"use strict";Rs.exports={version:"9.9.0"}});var js=O((dd,$s)=>{"use strict";var{EventEmitter:eu}=N("node:events"),{lsCacheSym:tu,levelValSym:ru,setLevelSym:fr,getLevelSym:Is,chindingsSym:hr,parsedChindingsSym:nu,mixinSym:su,asJsonSym:Ps,writeSym:iu,mixinMergeStrategySym:ou,timeSym:au,timeSliceIndexSym:cu,streamSym:Ls,serializersSym:ce,formattersSym:lr,errorKeySym:uu,messageKeySym:lu,useOnlyCustomLevelsSym:fu,needsMetadataGsym:du,redactFmtSym:hu,stringifySym:pu,formatOptsSym:mu,stringifiersSym:gu,msgPrefixSym:dr,hooksSym:yu}=Se(),{getLevel:wu,setLevel:bu,isLevelEnabled:Su,mappings:xu,initialLsCache:Eu,genLsCache:vu,assertNoLevelCollisions:Ou}=cr(),{asChindings:Ns,asJson:_u,buildFormatters:As,stringify:Ts}=at(),{version:Ru}=ur(),Iu=Vt(),Au=class{},Ms={constructor:Au,child:Tu,bindings:Cu,setBindings:Pu,flush:$u,isLevelEnabled:Su,version:Ru,get level(){return this[Is]()},set level(e){this[fr](e)},get levelVal(){return this[ru]},set levelVal(e){throw Error("levelVal is read-only")},get msgPrefix(){return this[dr]},[tu]:Eu,[iu]:Nu,[Ps]:_u,[Is]:wu,[fr]:bu};Object.setPrototypeOf(Ms,eu.prototype);$s.exports=function(){return Object.create(Ms)};var Cs=e=>e;function Tu(e,t){if(!e)throw Error("missing bindings for child Pino");t=t||{};let r=this[ce],n=this[lr],s=Object.create(this);if(t.hasOwnProperty("serializers")===!0){s[ce]=Object.create(null);for(let f in r)s[ce][f]=r[f];let l=Object.getOwnPropertySymbols(r);for(var i=0;i<l.length;i++){let f=l[i];s[ce][f]=r[f]}for(let f in t.serializers)s[ce][f]=t.serializers[f];let d=Object.getOwnPropertySymbols(t.serializers);for(var o=0;o<d.length;o++){let f=d[o];s[ce][f]=t.serializers[f]}}else s[ce]=r;if(t.hasOwnProperty("formatters")){let{level:l,bindings:d,log:f}=t.formatters;s[lr]=As(l||n.level,d||Cs,f||n.log)}else s[lr]=As(n.level,Cs,n.log);if(t.hasOwnProperty("customLevels")===!0&&(Ou(this.levels,t.customLevels),s.levels=xu(t.customLevels,s[fu]),vu(s)),typeof t.redact=="object"&&t.redact!==null||Array.isArray(t.redact)){s.redact=t.redact;let l=Iu(s.redact,Ts),d={stringify:l[hu]};s[pu]=Ts,s[gu]=l,s[mu]=d}typeof t.msgPrefix=="string"&&(s[dr]=(this[dr]||"")+t.msgPrefix),s[hr]=Ns(s,e);let a=t.level||this.level;return s[fr](a),this.onChild(s),s}function Cu(){let t=`{${this[hr].substr(1)}}`,r=JSON.parse(t);return delete r.pid,delete r.hostname,r}function Pu(e){let t=Ns(this,e);this[hr]=t,delete this[nu]}function Lu(e,t){return Object.assign(t,e)}function Nu(e,t,r){let n=this[au](),s=this[su],i=this[uu],o=this[lu],a=this[ou]||Lu,l,d=this[yu].streamWrite;e==null?l={}:e instanceof Error?(l={[i]:e},t===void 0&&(t=e.message)):(l=e,t===void 0&&e[o]===void 0&&e[i]&&(t=e[i].message)),s&&(l=a(l,s(l,r,this)));let f=this[Ps](l,t,r,n),u=this[Ls];u[du]===!0&&(u.lastLevel=r,u.lastObj=l,u.lastMsg=t,u.lastTime=n.slice(this[cu]),u.lastLogger=this),u.write(d?d(f):f)}function Mu(){}function $u(e){if(e!=null&&typeof e!="function")throw Error("callback must be a function");let t=this[Ls];typeof t.flush=="function"?t.flush(e||Mu):e&&e()}});var Bs=O((yr,zs)=>{"use strict";var{hasOwnProperty:Ce}=Object.prototype,le=gr();le.configure=gr;le.stringify=le;le.default=le;yr.stringify=le;yr.configure=gr;zs.exports=le;var ju=/[\u0000-\u001f\u0022\u005c\ud800-\udfff]/;function ee(e){return e.length<5e3&&!ju.test(e)?`"${e}"`:JSON.stringify(e)}function pr(e,t){if(e.length>200||t)return e.sort(t);for(let r=1;r<e.length;r++){let n=e[r],s=r;for(;s!==0&&e[s-1]>n;)e[s]=e[s-1],s--;e[s]=n}return e}var ku=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(Object.getPrototypeOf(new Int8Array)),Symbol.toStringTag).get;function mr(e){return ku.call(e)!==void 0&&e.length!==0}function ks(e,t,r){e.length<r&&(r=e.length);let n=t===","?"":" ",s=`"0":${n}${e[0]}`;for(let i=1;i<r;i++)s+=`${t}"${i}":${n}${e[i]}`;return s}function Du(e){if(Ce.call(e,"circularValue")){let t=e.circularValue;if(typeof t=="string")return`"${t}"`;if(t==null)return t;if(t===Error||t===TypeError)return{toString(){throw new TypeError("Converting circular structure to JSON")}};throw new TypeError('The "circularValue" argument must be of type string or the value null or undefined')}return'"[Circular]"'}function zu(e){let t;if(Ce.call(e,"deterministic")&&(t=e.deterministic,typeof t!="boolean"&&typeof t!="function"))throw new TypeError('The "deterministic" argument must be of type boolean or comparator function');return t===void 0?!0:t}function Bu(e,t){let r;if(Ce.call(e,t)&&(r=e[t],typeof r!="boolean"))throw new TypeError(`The "${t}" argument must be of type boolean`);return r===void 0?!0:r}function Ds(e,t){let r;if(Ce.call(e,t)){if(r=e[t],typeof r!="number")throw new TypeError(`The "${t}" argument must be of type number`);if(!Number.isInteger(r))throw new TypeError(`The "${t}" argument must be an integer`);if(r<1)throw new RangeError(`The "${t}" argument must be >= 1`)}return r===void 0?1/0:r}function ue(e){return e===1?"1 item":`${e} items`}function qu(e){let t=new Set;for(let r of e)(typeof r=="string"||typeof r=="number")&&t.add(String(r));return t}function Fu(e){if(Ce.call(e,"strict")){let t=e.strict;if(typeof t!="boolean")throw new TypeError('The "strict" argument must be of type boolean');if(t)return r=>{let n=`Object can not safely be stringified. Received type ${typeof r}`;throw typeof r!="function"&&(n+=` (${r.toString()})`),new Error(n)}}}function gr(e){e={...e};let t=Fu(e);t&&(e.bigint===void 0&&(e.bigint=!1),"circularValue"in e||(e.circularValue=Error));let r=Du(e),n=Bu(e,"bigint"),s=zu(e),i=typeof s=="function"?s:void 0,o=Ds(e,"maximumDepth"),a=Ds(e,"maximumBreadth");function l(h,c,y,g,S,w){let b=c[h];switch(typeof b=="object"&&b!==null&&typeof b.toJSON=="function"&&(b=b.toJSON(h)),b=g.call(c,h,b),typeof b){case"string":return ee(b);case"object":{if(b===null)return"null";if(y.indexOf(b)!==-1)return r;let x="",v=",",_=w;if(Array.isArray(b)){if(b.length===0)return"[]";if(o<y.length+1)return'"[Array]"';y.push(b),S!==""&&(w+=S,x+=`
${w}`,v=`,
${w}`);let P=Math.min(b.length,a),D=0;for(;D<P-1;D++){let oe=l(String(D),b,y,g,S,w);x+=oe!==void 0?oe:"null",x+=v}let z=l(String(D),b,y,g,S,w);if(x+=z!==void 0?z:"null",b.length-1>a){let oe=b.length-a-1;x+=`${v}"... ${ue(oe)} not stringified"`}return S!==""&&(x+=`
${_}`),y.pop(),`[${x}]`}let R=Object.keys(b),I=R.length;if(I===0)return"{}";if(o<y.length+1)return'"[Object]"';let E="",T="";S!==""&&(w+=S,v=`,
${w}`,E=" ");let M=Math.min(I,a);s&&!mr(b)&&(R=pr(R,i)),y.push(b);for(let P=0;P<M;P++){let D=R[P],z=l(D,b,y,g,S,w);z!==void 0&&(x+=`${T}${ee(D)}:${E}${z}`,T=v)}if(I>a){let P=I-a;x+=`${T}"...":${E}"${ue(P)} not stringified"`,T=v}return S!==""&&T.length>1&&(x=`
${w}${x}
${_}`),y.pop(),`{${x}}`}case"number":return isFinite(b)?String(b):t?t(b):"null";case"boolean":return b===!0?"true":"false";case"undefined":return;case"bigint":if(n)return String(b);default:return t?t(b):void 0}}function d(h,c,y,g,S,w){switch(typeof c=="object"&&c!==null&&typeof c.toJSON=="function"&&(c=c.toJSON(h)),typeof c){case"string":return ee(c);case"object":{if(c===null)return"null";if(y.indexOf(c)!==-1)return r;let b=w,x="",v=",";if(Array.isArray(c)){if(c.length===0)return"[]";if(o<y.length+1)return'"[Array]"';y.push(c),S!==""&&(w+=S,x+=`
${w}`,v=`,
${w}`);let I=Math.min(c.length,a),E=0;for(;E<I-1;E++){let M=d(String(E),c[E],y,g,S,w);x+=M!==void 0?M:"null",x+=v}let T=d(String(E),c[E],y,g,S,w);if(x+=T!==void 0?T:"null",c.length-1>a){let M=c.length-a-1;x+=`${v}"... ${ue(M)} not stringified"`}return S!==""&&(x+=`
${b}`),y.pop(),`[${x}]`}y.push(c);let _="";S!==""&&(w+=S,v=`,
${w}`,_=" ");let R="";for(let I of g){let E=d(I,c[I],y,g,S,w);E!==void 0&&(x+=`${R}${ee(I)}:${_}${E}`,R=v)}return S!==""&&R.length>1&&(x=`
${w}${x}
${b}`),y.pop(),`{${x}}`}case"number":return isFinite(c)?String(c):t?t(c):"null";case"boolean":return c===!0?"true":"false";case"undefined":return;case"bigint":if(n)return String(c);default:return t?t(c):void 0}}function f(h,c,y,g,S){switch(typeof c){case"string":return ee(c);case"object":{if(c===null)return"null";if(typeof c.toJSON=="function"){if(c=c.toJSON(h),typeof c!="object")return f(h,c,y,g,S);if(c===null)return"null"}if(y.indexOf(c)!==-1)return r;let w=S;if(Array.isArray(c)){if(c.length===0)return"[]";if(o<y.length+1)return'"[Array]"';y.push(c),S+=g;let E=`
${S}`,T=`,
${S}`,M=Math.min(c.length,a),P=0;for(;P<M-1;P++){let z=f(String(P),c[P],y,g,S);E+=z!==void 0?z:"null",E+=T}let D=f(String(P),c[P],y,g,S);if(E+=D!==void 0?D:"null",c.length-1>a){let z=c.length-a-1;E+=`${T}"... ${ue(z)} not stringified"`}return E+=`
${w}`,y.pop(),`[${E}]`}let b=Object.keys(c),x=b.length;if(x===0)return"{}";if(o<y.length+1)return'"[Object]"';S+=g;let v=`,
${S}`,_="",R="",I=Math.min(x,a);mr(c)&&(_+=ks(c,v,a),b=b.slice(c.length),I-=c.length,R=v),s&&(b=pr(b,i)),y.push(c);for(let E=0;E<I;E++){let T=b[E],M=f(T,c[T],y,g,S);M!==void 0&&(_+=`${R}${ee(T)}: ${M}`,R=v)}if(x>a){let E=x-a;_+=`${R}"...": "${ue(E)} not stringified"`,R=v}return R!==""&&(_=`
${S}${_}
${w}`),y.pop(),`{${_}}`}case"number":return isFinite(c)?String(c):t?t(c):"null";case"boolean":return c===!0?"true":"false";case"undefined":return;case"bigint":if(n)return String(c);default:return t?t(c):void 0}}function u(h,c,y){switch(typeof c){case"string":return ee(c);case"object":{if(c===null)return"null";if(typeof c.toJSON=="function"){if(c=c.toJSON(h),typeof c!="object")return u(h,c,y);if(c===null)return"null"}if(y.indexOf(c)!==-1)return r;let g="",S=c.length!==void 0;if(S&&Array.isArray(c)){if(c.length===0)return"[]";if(o<y.length+1)return'"[Array]"';y.push(c);let _=Math.min(c.length,a),R=0;for(;R<_-1;R++){let E=u(String(R),c[R],y);g+=E!==void 0?E:"null",g+=","}let I=u(String(R),c[R],y);if(g+=I!==void 0?I:"null",c.length-1>a){let E=c.length-a-1;g+=`,"... ${ue(E)} not stringified"`}return y.pop(),`[${g}]`}let w=Object.keys(c),b=w.length;if(b===0)return"{}";if(o<y.length+1)return'"[Object]"';let x="",v=Math.min(b,a);S&&mr(c)&&(g+=ks(c,",",a),w=w.slice(c.length),v-=c.length,x=","),s&&(w=pr(w,i)),y.push(c);for(let _=0;_<v;_++){let R=w[_],I=u(R,c[R],y);I!==void 0&&(g+=`${x}${ee(R)}:${I}`,x=",")}if(b>a){let _=b-a;g+=`${x}"...":"${ue(_)} not stringified"`}return y.pop(),`{${g}}`}case"number":return isFinite(c)?String(c):t?t(c):"null";case"boolean":return c===!0?"true":"false";case"undefined":return;case"bigint":if(n)return String(c);default:return t?t(c):void 0}}function m(h,c,y){if(arguments.length>1){let g="";if(typeof y=="number"?g=" ".repeat(Math.min(y,10)):typeof y=="string"&&(g=y.slice(0,10)),c!=null){if(typeof c=="function")return l("",{"":h},[],c,g,"");if(Array.isArray(c))return d("",h,[],qu(c),g,"")}if(g.length!==0)return f("",h,[],g,"")}return u("",h,[])}return m}});var Us=O((hd,Vs)=>{"use strict";var wr=Symbol.for("pino.metadata"),{DEFAULT_LEVELS:Fs}=ct(),Vu=Fs.info;function Uu(e,t){e=e||[],t=t||{dedupe:!1};let r=Object.create(Fs);r.silent=1/0,t.levels&&typeof t.levels=="object"&&Object.keys(t.levels).forEach(u=>{r[u]=t.levels[u]});let n={write:s,add:a,remove:l,emit:i,flushSync:o,end:d,minLevel:0,lastId:0,streams:[],clone:f,[wr]:!0,streamLevels:r};return Array.isArray(e)?e.forEach(a,n):a.call(n,e),e=null,n;function s(u){let m,h=this.lastLevel,{streams:c}=this,y=0,g;for(let S=Wu(c.length,t.dedupe);Ju(S,c.length,t.dedupe);S=Gu(S,t.dedupe))if(m=c[S],m.level<=h){if(y!==0&&y!==m.level)break;if(g=m.stream,g[wr]){let{lastTime:w,lastMsg:b,lastObj:x,lastLogger:v}=this;g.lastLevel=h,g.lastTime=w,g.lastMsg=b,g.lastObj=x,g.lastLogger=v}g.write(u),t.dedupe&&(y=m.level)}else if(!t.dedupe)break}function i(...u){for(let{stream:m}of this.streams)typeof m.emit=="function"&&m.emit(...u)}function o(){for(let{stream:u}of this.streams)typeof u.flushSync=="function"&&u.flushSync()}function a(u){if(!u)return n;let m=typeof u.write=="function"||u.stream,h=u.write?u:u.stream;if(!m)throw Error("stream object needs to implement either StreamEntry or DestinationStream interface");let{streams:c,streamLevels:y}=this,g;typeof u.levelVal=="number"?g=u.levelVal:typeof u.level=="string"?g=y[u.level]:typeof u.level=="number"?g=u.level:g=Vu;let S={stream:h,level:g,levelVal:void 0,id:++n.lastId};return c.unshift(S),c.sort(qs),this.minLevel=c[0].level,n}function l(u){let{streams:m}=this,h=m.findIndex(c=>c.id===u);return h>=0&&(m.splice(h,1),m.sort(qs),this.minLevel=m.length>0?m[0].level:-1),n}function d(){for(let{stream:u}of this.streams)typeof u.flushSync=="function"&&u.flushSync(),u.end()}function f(u){let m=new Array(this.streams.length);for(let h=0;h<m.length;h++)m[h]={level:u,stream:this.streams[h].stream};return{write:s,add:a,remove:l,minLevel:u,streams:m,clone:f,emit:i,flushSync:o,[wr]:!0}}}function qs(e,t){return e.level-t.level}function Wu(e,t){return t?e-1:0}function Gu(e,t){return t?e-1:e+1}function Ju(e,t,r){return r?e>=0:e<t}Vs.exports=Uu});var si=O((pd,B)=>{"use strict";var Hu=N("node:os"),Zs=$t(),Ku=jt(),Yu=Vt(),Qs=kn(),Xu=js(),ei=Se(),{configure:Zu}=Bs(),{assertDefaultLevelFound:Qu,mappings:ti,genLsCache:el,genLevelComparison:tl,assertLevelComparison:rl}=cr(),{DEFAULT_LEVELS:ri,SORTING_ORDER:nl}=ct(),{createArgsNormalizer:sl,asChindings:il,buildSafeSonicBoom:Ws,buildFormatters:ol,stringify:br,normalizeDestFileDescriptor:Gs,noop:al}=at(),{version:cl}=ur(),{chindingsSym:Js,redactFmtSym:ul,serializersSym:Hs,timeSym:ll,timeSliceIndexSym:fl,streamSym:dl,stringifySym:Ks,stringifySafeSym:Sr,stringifiersSym:Ys,setLevelSym:hl,endSym:pl,formatOptsSym:ml,messageKeySym:gl,errorKeySym:yl,nestedKeySym:wl,mixinSym:bl,levelCompSym:Sl,useOnlyCustomLevelsSym:xl,formattersSym:Xs,hooksSym:El,nestedKeyStrSym:vl,mixinMergeStrategySym:Ol,msgPrefixSym:_l}=ei,{epochTime:ni,nullTime:Rl}=Qs,{pid:Il}=process,Al=Hu.hostname(),Tl=Zs.err,Cl={level:"info",levelComparison:nl.ASC,levels:ri,messageKey:"msg",errorKey:"err",nestedKey:null,enabled:!0,base:{pid:Il,hostname:Al},serializers:Object.assign(Object.create(null),{err:Tl}),formatters:Object.assign(Object.create(null),{bindings(e){return e},level(e,t){return{level:t}}}),hooks:{logMethod:void 0,streamWrite:void 0},timestamp:ni,name:void 0,redact:null,customLevels:null,useOnlyCustomLevels:!1,depthLimit:5,edgeLimit:100},Pl=sl(Cl),Ll=Object.assign(Object.create(null),Zs);function xr(...e){let t={},{opts:r,stream:n}=Pl(t,Ku(),...e);r.level&&typeof r.level=="string"&&ri[r.level.toLowerCase()]!==void 0&&(r.level=r.level.toLowerCase());let{redact:s,crlf:i,serializers:o,timestamp:a,messageKey:l,errorKey:d,nestedKey:f,base:u,name:m,level:h,customLevels:c,levelComparison:y,mixin:g,mixinMergeStrategy:S,useOnlyCustomLevels:w,formatters:b,hooks:x,depthLimit:v,edgeLimit:_,onChild:R,msgPrefix:I}=r,E=Zu({maximumDepth:v,maximumBreadth:_}),T=ol(b.level,b.bindings,b.log),M=br.bind({[Sr]:E}),P=s?Yu(s,M):{},D=s?{stringify:P[ul]}:{stringify:M},z="}"+(i?`\r
`:`
`),oe=il.bind(null,{[Js]:"",[Hs]:o,[Ys]:P,[Ks]:br,[Sr]:E,[Xs]:T}),_t="";u!==null&&(m===void 0?_t=oe(u):_t=oe(Object.assign({},u,{name:m})));let Ur=a instanceof Function?a:a?ni:Rl,Ci=Ur().indexOf(":")+1;if(w&&!c)throw Error("customLevels is required if useOnlyCustomLevels is set true");if(g&&typeof g!="function")throw Error(`Unknown mixin type "${typeof g}" - expected "function"`);if(I&&typeof I!="string")throw Error(`Unknown msgPrefix type "${typeof I}" - expected "string"`);Qu(h,c,w);let Wr=ti(c,w);typeof n.emit=="function"&&n.emit("message",{code:"PINO_CONFIG",config:{levels:Wr,messageKey:l,errorKey:d}}),rl(y);let Pi=tl(y);return Object.assign(t,{levels:Wr,[Sl]:Pi,[xl]:w,[dl]:n,[ll]:Ur,[fl]:Ci,[Ks]:br,[Sr]:E,[Ys]:P,[pl]:z,[ml]:D,[gl]:l,[yl]:d,[wl]:f,[vl]:f?`,${JSON.stringify(f)}:{`:"",[Hs]:o,[bl]:g,[Ol]:S,[Js]:_t,[Xs]:T,[El]:x,silent:al,onChild:R,[_l]:I}),Object.setPrototypeOf(t,Xu()),el(t),t[hl](h),t}B.exports=xr;B.exports.destination=(e=process.stdout.fd)=>typeof e=="object"?(e.dest=Gs(e.dest||process.stdout.fd),Ws(e)):Ws({dest:Gs(e),minLength:0});B.exports.transport=rr();B.exports.multistream=Us();B.exports.levels=ti();B.exports.stdSerializers=Ll;B.exports.stdTimeFunctions=Object.assign({},Qs);B.exports.symbols=ei;B.exports.version=cl;B.exports.default=xr;B.exports.pino=xr});var Ti=Di(si());var ut=Array.isArray;function te(e){return e[0]??{}}function W(e){return Array.isArray(e)?e:e==null?[]:[e]}var lt="orpc",Hl="@orpc/shared",Kl="1.8.4";function Er(e){let t;return()=>{if(t)return t.result;let r=e();return t={result:r},r}}function Yl(e){let t=Promise.resolve();return(...r)=>t=t.catch(()=>{}).then(()=>e(...r))}var Xl=2,Zl=`__${Hl}@${Kl}/otel/config__`;function ft(){return globalThis[Zl]}function dt(e,t={},r){return ft()?.tracer?.startSpan(e,t,r)}function V(e,t,r={}){if(!e)return;let n=Ql(t);e.recordException(n),(!r.signal?.aborted||r.signal.reason!==t)&&e.setStatus({code:Xl,message:n.message})}function Ql(e){if(e instanceof Error){let t={message:e.message,name:e.name,stack:e.stack};return"code"in e&&(typeof e.code=="string"||typeof e.code=="number")&&(t.code=e.code),t}return{message:String(e)}}async function j({name:e,context:t,...r},n){let s=ft()?.tracer;if(!s)return n();let i=async o=>{try{return await n(o)}catch(a){throw V(o,a,r),a}finally{o.end()}};return t?s.startActiveSpan(e,r,t,i):s.startActiveSpan(e,r,i)}async function fe(e,t){let r=ft();if(!e||!r)return t();let n=r.trace.setSpan(r.context.active(),e);return r.context.with(n,t)}function k(e){return!e||typeof e!="object"?!1:"next"in e&&typeof e.next=="function"&&Symbol.asyncIterator in e&&typeof e[Symbol.asyncIterator]=="function"}var ef=Symbol.for("asyncDispose"),tf=Symbol.asyncDispose??ef,U=class{#t=!1;#e=!1;#r;#n;constructor(t,r){this.#r=r,this.#n=Yl(async()=>{if(this.#t)return{done:!0,value:void 0};try{let n=await t();return n.done&&(this.#t=!0),n}catch(n){throw this.#t=!0,n}finally{this.#t&&!this.#e&&(this.#e=!0,await this.#r("next"))}})}next(){return this.#n()}async return(t){return this.#t=!0,this.#e||(this.#e=!0,await this.#r("return")),{done:!0,value:t}}async throw(t){throw this.#t=!0,this.#e||(this.#e=!0,await this.#r("throw")),t}async[tf](){this.#t=!0,this.#e||(this.#e=!0,await this.#r("dispose"))}[Symbol.asyncIterator](){return this}};function Pe({name:e,...t},r){let n;return new U(async()=>{n??=dt(e);try{let s=await fe(n,()=>r.next());return n?.addEvent(s.done?"completed":"yielded"),s}catch(s){throw V(n,s,t),s}},async s=>{try{s!=="next"&&await fe(n,()=>r.return?.())}catch(i){throw V(n,i,t),i}finally{n?.end()}})}function re(e,t,r){let n=(s,i)=>{let o=e[i];return o?o({...s,next:(a=s)=>n(a,i+1)}):r(s)};return n(t,0)}function ne(e){if(e)return JSON.parse(e)}function de(e){return JSON.stringify(e)}function Le(e){if(!e||typeof e!="object")return!1;let t=Object.getPrototypeOf(e);return t===Object.prototype||!t||!t.constructor}function X(e){return!!e&&(typeof e=="object"||typeof e=="function")}var oi=(()=>{let e=function(){};return e.prototype=Object.create(null),Object.freeze(e.prototype),e})();function ai(e){try{return decodeURIComponent(e)}catch{return e}}function se(e,...t){return typeof e=="function"?e(...t):e}var ve=class extends TypeError{},vr=class extends TypeError{},G=class extends Error{data;constructor(t){super(t?.message??"An error event was received",t),this.data=t?.data}};function rf(e){let t=e.replace(/\n+$/,"").split(/\n/),r={data:void 0,event:void 0,id:void 0,retry:void 0,comments:[]};for(let n of t){let s=n.indexOf(":"),i=s===-1?n:n.slice(0,s),o=s===-1?"":n.slice(s+1).replace(/^\s/,"");if(s===0)r.comments.push(o);else if(i==="data")r.data??="",r.data+=`${o}
`;else if(i==="event")r.event=o;else if(i==="id")r.id=o;else if(i==="retry"){let a=Number.parseInt(o);Number.isInteger(a)&&a>=0&&a.toString()===o&&(r.retry=a)}}return r.data=r.data?.replace(/\n$/,""),r}var Or=class{constructor(t={}){this.options=t}incomplete="";feed(t){this.incomplete+=t;let r=this.incomplete.lastIndexOf(`

`);if(r===-1)return;let n=this.incomplete.slice(0,r).split(/\n\n/);this.incomplete=this.incomplete.slice(r+2);for(let s of n){let i=rf(`${s}

`);this.options.onEvent&&this.options.onEvent(i)}this.incomplete=""}end(){if(this.incomplete)throw new vr("Event Iterator ended before complete")}},ht=class extends TransformStream{constructor(){let t;super({start(r){t=new Or({onEvent:n=>{r.enqueue(n)}})},transform(r){t.feed(r)},flush(){t.end()}})}};function ci(e){if(e.includes(`
`))throw new ve("Event's id must not contain a newline character")}function nf(e){if(e.includes(`
`))throw new ve("Event's event must not contain a newline character")}function ui(e){if(!Number.isInteger(e)||e<0)throw new ve("Event's retry must be a integer and >= 0")}function li(e){if(e.includes(`
`))throw new ve("Event's comment must not contain a newline character")}function sf(e){let t=e?.split(/\n/)??[],r="";for(let n of t)r+=`data: ${n}
`;return r}function of(e){let t="";for(let r of e??[])li(r),t+=`: ${r}
`;return t}function mt(e){let t="";return t+=of(e.comments),e.event!==void 0&&(nf(e.event),t+=`event: ${e.event}
`),e.retry!==void 0&&(ui(e.retry),t+=`retry: ${e.retry}
`),e.id!==void 0&&(ci(e.id),t+=`id: ${e.id}
`),t+=sf(e.data),t+=`
`,t}var fi=Symbol("ORPC_EVENT_SOURCE_META");function ie(e,t){if(t.id!==void 0&&ci(t.id),t.retry!==void 0&&ui(t.retry),t.comments!==void 0)for(let r of t.comments)li(r);return new Proxy(e,{get(r,n,s){return n===fi?t:Reflect.get(r,n,s)}})}function he(e){return X(e)?Reflect.get(e,fi):void 0}var pt=class extends U{hibernationCallback;constructor(t){super(async()=>{throw new Error("Cannot iterate over hibernating iterator directly")},async r=>{if(r!=="next")throw new Error("Cannot cleanup hibernating iterator directly")}),this.hibernationCallback=t}};function di(e){let t=e.replace(/"/g,'\\"'),r=encodeURIComponent(e).replace(/['()*]/g,n=>`%${n.charCodeAt(0).toString(16).toUpperCase()}`).replace(/%(7C|60|5E)/g,(n,s)=>String.fromCharCode(Number.parseInt(s,16)));return`inline; filename="${t}"; filename*=utf-8''${r}`}function hi(e){let t=e.match(/filename\*=(UTF-8'')?([^;]*)/i);if(t&&typeof t[2]=="string")return ai(t[2]);let r=e.match(/filename="((?:\\"|[^"])*)"/i);if(r&&typeof r[1]=="string")return r[1].replace(/\\"/g,'"')}function pe(e){if(typeof e=="string"||e===void 0)return e;if(e.length!==0)return e.join(", ")}var gt={BAD_REQUEST:{status:400,message:"Bad Request"},UNAUTHORIZED:{status:401,message:"Unauthorized"},FORBIDDEN:{status:403,message:"Forbidden"},NOT_FOUND:{status:404,message:"Not Found"},METHOD_NOT_SUPPORTED:{status:405,message:"Method Not Supported"},NOT_ACCEPTABLE:{status:406,message:"Not Acceptable"},TIMEOUT:{status:408,message:"Request Timeout"},CONFLICT:{status:409,message:"Conflict"},PRECONDITION_FAILED:{status:412,message:"Precondition Failed"},PAYLOAD_TOO_LARGE:{status:413,message:"Payload Too Large"},UNSUPPORTED_MEDIA_TYPE:{status:415,message:"Unsupported Media Type"},UNPROCESSABLE_CONTENT:{status:422,message:"Unprocessable Content"},TOO_MANY_REQUESTS:{status:429,message:"Too Many Requests"},CLIENT_CLOSED_REQUEST:{status:499,message:"Client Closed Request"},INTERNAL_SERVER_ERROR:{status:500,message:"Internal Server Error"},NOT_IMPLEMENTED:{status:501,message:"Not Implemented"},BAD_GATEWAY:{status:502,message:"Bad Gateway"},SERVICE_UNAVAILABLE:{status:503,message:"Service Unavailable"},GATEWAY_TIMEOUT:{status:504,message:"Gateway Timeout"}};function yt(e,t){return t??gt[e]?.status??500}function pi(e,t){return t||gt[e]?.message||e}var A=class extends Error{defined;code;status;data;constructor(t,...r){let n=te(r);if(n.status!==void 0&&!ge(n.status))throw new Error("[ORPCError] Invalid error status code.");let s=pi(t,n.message);super(s,n),this.code=t,this.status=yt(t,n.status),this.defined=n.defined??!1,this.data=n.data}toJSON(){return{defined:this.defined,code:this.code,status:this.status,message:this.message,data:this.data}}};function me(e){return e instanceof A?e:new A("INTERNAL_SERVER_ERROR",{message:"Internal server error",cause:e})}function ge(e){return e<200||e>=400}function _r(e){if(!Le(e))return!1;let t=["defined","code","status","message","data"];return Object.keys(e).some(r=>!t.includes(r))?!1:"defined"in e&&typeof e.defined=="boolean"&&"code"in e&&typeof e.code=="string"&&"status"in e&&typeof e.status=="number"&&ge(e.status)&&"message"in e&&typeof e.message=="string"}function Rr(e,t={}){return new A(e.code,{...t,...e})}function ye(e,t){let r=async n=>{let s=await t.error(n);if(s!==n){let i=he(n);i&&X(s)&&(s=ie(s,i))}return s};return new U(async()=>{let{done:n,value:s}=await(async()=>{try{return await e.next()}catch(o){throw await r(o)}})(),i=await t.value(s,n);if(i!==s){let o=he(s);o&&X(i)&&(i=ie(i,o))}return{done:n,value:i}},async()=>{try{await e.return?.()}catch(n){throw await r(n)}})}function mf(e,t={}){let n=e?.pipeThrough(new TextDecoderStream).pipeThrough(new ht)?.getReader(),s;return new U(async()=>{s??=dt("consume_event_iterator_stream");try{for(;;){if(n===void 0)return{done:!0,value:void 0};let{done:i,value:o}=await fe(s,()=>n.read());if(i)return{done:!0,value:void 0};switch(o.event){case"message":{let a=ne(o.data);return X(a)&&(a=ie(a,o)),s?.addEvent("message"),{done:!1,value:a}}case"error":{let a=new G({data:ne(o.data)});throw a=ie(a,o),s?.addEvent("error"),a}case"done":{let a=ne(o.data);return X(a)&&(a=ie(a,o)),s?.addEvent("done"),{done:!0,value:a}}default:s?.addEvent("maybe_keepalive")}}}catch(i){throw i instanceof G||V(s,i,t),i}},async i=>{try{i!=="next"&&s?.addEvent("cancelled"),await fe(s,()=>n?.cancel())}catch(o){throw V(s,o,t),o}finally{s?.end()}})}function gf(e,t={}){let r=t.eventIteratorKeepAliveEnabled??!0,n=t.eventIteratorKeepAliveInterval??5e3,s=t.eventIteratorKeepAliveComment??"",i=!1,o,a;return new ReadableStream({start(){a=dt("stream_event_iterator")},async pull(d){try{r&&(o=setInterval(()=>{d.enqueue(mt({comments:[s]})),a?.addEvent("keepalive")},n));let f=await fe(a,()=>e.next());if(clearInterval(o),i)return;let u=he(f.value);if(!f.done||f.value!==void 0||u!==void 0){let m=f.done?"done":"message";d.enqueue(mt({...u,event:m,data:de(f.value)})),a?.addEvent(m)}f.done&&(d.close(),a?.end())}catch(f){if(clearInterval(o),i)return;f instanceof G?(d.enqueue(mt({...he(f),event:"error",data:de(f.data)})),a?.addEvent("error"),d.close()):(V(a,f),d.error(f)),a?.end()}},async cancel(){try{i=!0,clearInterval(o),a?.addEvent("cancelled"),await fe(a,()=>e.return?.())}catch(d){throw V(a,d),d}finally{a?.end()}}}).pipeThrough(new TextEncoderStream)}function yf(e,t={}){return j({name:"parse_standard_body",signal:t.signal},async()=>{let r=e.headers.get("content-disposition");if(typeof r=="string"){let i=hi(r)??"blob",o=await e.blob();return new File([o],i,{type:o.type})}let n=e.headers.get("content-type");if(!n||n.startsWith("application/json")){let i=await e.text();return ne(i)}if(n.startsWith("multipart/form-data"))return await e.formData();if(n.startsWith("application/x-www-form-urlencoded")){let i=await e.text();return new URLSearchParams(i)}if(n.startsWith("text/event-stream"))return mf(e.body,t);if(n.startsWith("text/plain"))return await e.text();let s=await e.blob();return new File([s],"blob",{type:s.type})})}function wf(e,t,r={}){let n=t.get("content-disposition");if(t.delete("content-type"),t.delete("content-disposition"),e!==void 0)return e instanceof Blob?(t.set("content-type",e.type),t.set("content-length",e.size.toString()),t.set("content-disposition",n??di(e instanceof File?e.name:"blob")),e):e instanceof FormData||e instanceof URLSearchParams?e:k(e)?(t.set("content-type","text/event-stream"),gf(e,r)):(t.set("content-type","application/json"),de(e))}function bf(e,t={}){for(let[r,n]of e)Array.isArray(t[r])?t[r].push(n):t[r]!==void 0?t[r]=[t[r],n]:t[r]=n;return t}function mi(e,t=new Headers){for(let[r,n]of Object.entries(e))if(Array.isArray(n))for(let s of n)t.append(r,s);else n!==void 0&&t.append(r,n);return t}function gi(e){return{url:new URL(e.url),signal:e.signal,method:e.method,body:Er(()=>yf(e,{signal:e.signal})),get headers(){let t=bf(e.headers);return Object.defineProperty(this,"headers",{value:t,writable:!0}),t},set headers(t){Object.defineProperty(this,"headers",{value:t,writable:!0})}}}function yi(e,t={}){let r=mi(e.headers),n=wf(e.body,r,t);return new Response(n,{headers:r,status:e.status})}function wi(e){return{...e,context:e.context??{}}}var Oe=class extends Error{issues;constructor(t){super(t.message,t),this.issues=t.issues}};function we(e,t){return{...e,...t}}function wt(e,t){return{...e,...t}}var Ne=class{"~orpc";constructor(t){if(t.route?.successStatus&&ge(t.route.successStatus))throw new Error("[ContractProcedure] Invalid successStatus.");if(Object.values(t.errorMap).some(r=>r&&r.status&&!ge(r.status)))throw new Error("[ContractProcedure] Invalid error status code.");this["~orpc"]=t}};function Me(e){return e instanceof Ne?!0:(typeof e=="object"||typeof e=="function")&&e!==null&&"~orpc"in e&&typeof e["~orpc"]=="object"&&e["~orpc"]!==null&&"errorMap"in e["~orpc"]&&"route"in e["~orpc"]&&"meta"in e["~orpc"]}function bt(e,t){return{...e,...t}}function Sf(e,t){return e.path?{...e,path:`${t}${e.path}`}:e}function xf(e,t){return{...e,tags:[...t,...e.tags??[]]}}function $e(e,t){return e?`${e}${t}`:t}function Ar(e,t){return e?[...e,...t]:t}function Tr(e,t){let r=e;return t.prefix&&(r=Sf(r,t.prefix)),t.tags?.length&&(r=xf(r,t.tags)),r}function bi(e,t){if(Me(e))return new Ne({...e["~orpc"],errorMap:we(t.errorMap,e["~orpc"].errorMap),route:Tr(e["~orpc"].route,t)});let r={};for(let n in e)r[n]=bi(e[n],t);return r}var Ir=class e extends Ne{constructor(t){super(t),this["~orpc"].prefix=t.prefix,this["~orpc"].tags=t.tags}$meta(t){return new e({...this["~orpc"],meta:t})}$route(t){return new e({...this["~orpc"],route:t})}errors(t){return new e({...this["~orpc"],errorMap:we(this["~orpc"].errorMap,t)})}meta(t){return new e({...this["~orpc"],meta:wt(this["~orpc"].meta,t)})}route(t){return new e({...this["~orpc"],route:bt(this["~orpc"].route,t)})}input(t){return new e({...this["~orpc"],inputSchema:t})}output(t){return new e({...this["~orpc"],outputSchema:t})}prefix(t){return new e({...this["~orpc"],prefix:$e(this["~orpc"].prefix,t)})}tag(...t){return new e({...this["~orpc"],tags:Ar(this["~orpc"].tags,t)})}router(t){return bi(t,this["~orpc"])}},Lp=new Ir({errorMap:{},route:{},meta:{}}),Ef={defaultMethod:"POST",defaultSuccessStatus:200,defaultSuccessDescription:"OK",defaultInputStructure:"compact",defaultOutputStructure:"compact"};function Cr(e,t){return t===void 0?Ef[e]:t}var Np=Symbol("ORPC_EVENT_ITERATOR_DETAILS");var L={BIGINT:0,DATE:1,NAN:2,UNDEFINED:3,URL:4,REGEXP:5,SET:6,MAP:7},je=class{customSerializers;constructor(t={}){if(this.customSerializers=t.customJsonSerializers??[],this.customSerializers.length!==new Set(this.customSerializers.map(r=>r.type)).size)throw new Error("Custom serializer type must be unique.")}serialize(t,r=[],n=[],s=[],i=[]){for(let o of this.customSerializers)if(o.condition(t)){let a=this.serialize(o.serialize(t),r,n,s,i);return n.push([o.type,...r]),a}if(t instanceof Blob)return s.push(r),i.push(t),[t,n,s,i];if(typeof t=="bigint")return n.push([L.BIGINT,...r]),[t.toString(),n,s,i];if(t instanceof Date)return n.push([L.DATE,...r]),Number.isNaN(t.getTime())?[null,n,s,i]:[t.toISOString(),n,s,i];if(Number.isNaN(t))return n.push([L.NAN,...r]),[null,n,s,i];if(t instanceof URL)return n.push([L.URL,...r]),[t.toString(),n,s,i];if(t instanceof RegExp)return n.push([L.REGEXP,...r]),[t.toString(),n,s,i];if(t instanceof Set){let o=this.serialize(Array.from(t),r,n,s,i);return n.push([L.SET,...r]),o}if(t instanceof Map){let o=this.serialize(Array.from(t.entries()),r,n,s,i);return n.push([L.MAP,...r]),o}if(Array.isArray(t))return[t.map((a,l)=>a===void 0?(n.push([L.UNDEFINED,...r,l]),a):this.serialize(a,[...r,l],n,s,i)[0]),n,s,i];if(Le(t)){let o={};for(let a in t)a==="toJSON"&&typeof t[a]=="function"||(o[a]=this.serialize(t[a],[...r,a],n,s,i)[0]);return[o,n,s,i]}return[t,n,s,i]}deserialize(t,r,n,s){let i={data:t};n&&s&&n.forEach((o,a)=>{let l=i,d="data";o.forEach(f=>{l=l[d],d=f}),l[d]=s(a)});for(let o of r){let a=o[0],l=i,d="data";for(let f=1;f<o.length;f++)l=l[d],d=o[f];for(let f of this.customSerializers)if(f.type===a){l[d]=f.deserialize(l[d]);break}switch(a){case L.BIGINT:l[d]=BigInt(l[d]);break;case L.DATE:l[d]=new Date(l[d]??"Invalid Date");break;case L.NAN:l[d]=Number.NaN;break;case L.UNDEFINED:l[d]=void 0;break;case L.URL:l[d]=new URL(l[d]);break;case L.REGEXP:{let[,f,u]=l[d].match(/^\/(.*)\/([a-z]*)$/);l[d]=new RegExp(f,u);break}case L.SET:l[d]=new Set(l[d]);break;case L.MAP:l[d]=new Map(l[d]);break}}return i.data}};function De(e){return`/${e.map(encodeURIComponent).join("/")}`}var ke=class{constructor(t){this.jsonSerializer=t}serialize(t){return k(t)?ye(t,{value:async r=>this.#t(r,!1),error:async r=>new G({data:this.#t(me(r).toJSON(),!1),cause:r})}):this.#t(t,!0)}#t(t,r){let[n,s,i,o]=this.jsonSerializer.serialize(t),a=s.length===0?void 0:s;if(!r||o.length===0)return{json:n,meta:a};let l=new FormData;return l.set("data",de({json:n,meta:a,maps:i})),o.forEach((d,f)=>{l.set(f.toString(),d)}),l}deserialize(t){return k(t)?ye(t,{value:async r=>this.#e(r),error:async r=>{if(!(r instanceof G))return r;let n=this.#e(r.data);return _r(n)?Rr(n,{cause:r}):new G({data:n,cause:r})}}):this.#e(t)}#e(t){if(t===void 0)return;if(!(t instanceof FormData))return this.jsonSerializer.deserialize(t.json,t.meta??[]);let r=JSON.parse(t.get("data"));return this.jsonSerializer.deserialize(r.json,r.meta??[],r.maps,n=>t.get(n.toString()))}};var Be=Symbol("ORPC_LAZY_SYMBOL");function St(e,t={}){return{[Be]:{loader:e,meta:t}}}function qe(e){return(typeof e=="object"||typeof e=="function")&&e!==null&&Be in e}function Pr(e){return e[Be].meta}function Q(e){return qe(e)?e[Be].loader():Promise.resolve({default:e})}function Si(e,t){if(t.length>e.length)return!1;for(let r=0;r<e.length;r++){if(t[r]===void 0)return!0;if(e[r]!==t[r])return!1}return!0}function xi(e,t,r){return r.dedupeLeading&&Si(t,e)?t:[...e,...t]}function Lr(e,t){return[...e,t]}var be=class{"~orpc";constructor(t){this["~orpc"]=t}};function _e(e){return e instanceof be?!0:Me(e)&&"middlewares"in e["~orpc"]&&"inputValidationIndex"in e["~orpc"]&&"outputValidationIndex"in e["~orpc"]&&"handler"in e["~orpc"]}function Ei(e,t){return{...e,...t}}function vi(e){return new Proxy(e,{get(r,n){return typeof n!="string"?Reflect.get(r,n):(...i)=>{let o=te(i),a=e[n];return new A(n,{defined:!!a,status:a?.status,message:o.message??a?.message,data:o.data,cause:o.cause})}}})}async function Oi(e,t){let{code:r,status:n,message:s,data:i,cause:o,defined:a}=t,l=e?.[t.code];if(!l||yt(t.code,l.status)!==t.status)return a?new A(r,{defined:!1,status:n,message:s,data:i,cause:o}):t;if(!l.data)return a?t:new A(r,{defined:!0,status:n,message:s,data:i,cause:o});let d=await l.data["~standard"].validate(t.data);return d.issues?a?new A(r,{defined:!1,status:n,message:s,data:i,cause:o}):t:new A(r,{defined:!0,status:n,message:s,data:d.value,cause:o})}function _i(e){return{output:e,context:{}}}function Fe(e,...t){let r=te(t);return async(...[n,s])=>{let i=W(r.path),{default:o}=await Q(e),a=s?.context??{},l=await se(r.context??{},a),d=vi(o["~orpc"].errorMap),f=async u=>u instanceof A?await Oi(o["~orpc"].errorMap,u):u;try{let u=await j({name:"call_procedure",signal:s?.signal},m=>(m?.setAttribute("procedure.path",[...i]),re(W(r.interceptors),{context:l,input:n,errors:d,path:i,procedure:o,signal:s?.signal,lastEventId:s?.lastEventId},h=>_f(h.procedure,h))));return k(u)?u instanceof pt?u:ye(Pe({name:"consume_event_iterator_output",signal:s?.signal},u),{value:m=>m,error:m=>f(m)}):u}catch(u){throw await f(u)}}}async function vf(e,t){let r=e["~orpc"].inputSchema;return r?j({name:"validate_input"},async()=>{let n=await r["~standard"].validate(t);if(n.issues)throw new A("BAD_REQUEST",{message:"Input validation failed",data:{issues:n.issues},cause:new Oe({message:"Input validation failed",issues:n.issues})});return n.value}):t}async function Of(e,t){let r=e["~orpc"].outputSchema;return r?j({name:"validate_output"},async()=>{let n=await r["~standard"].validate(t);if(n.issues)throw new A("INTERNAL_SERVER_ERROR",{message:"Output validation failed",cause:new Oe({message:"Output validation failed",issues:n.issues})});return n.value}):t}async function _f(e,t){let r=e["~orpc"].middlewares,n=Math.min(Math.max(0,e["~orpc"].inputValidationIndex),r.length),s=Math.min(Math.max(0,e["~orpc"].outputValidationIndex),r.length),i=async(o,a,l)=>{let d=l;o===n&&(d=await vf(e,d));let f=r[o],u=f?await j({name:`middleware.${f.name}`,signal:t.signal},async m=>(m?.setAttribute("middleware.index",o),m?.setAttribute("middleware.name",f.name),(await f({...t,context:a,next:async(...[c])=>{let y=c?.context??{};return{output:await i(o+1,Ei(a,y),d),context:y}}},d,_i)).output)):await j({name:"handler",signal:t.signal},()=>e["~orpc"].handler({...t,context:a,input:d}));return o===s?await Of(e,u):u};return i(0,t.context,t.input)}var Rf=Symbol("ORPC_HIDDEN_ROUTER_CONTRACT");function Ri(e){return e[Rf]}function Ve(e,t){let r=e;for(let n=0;n<t.length;n++){let s=t[n];if(!r||_e(r))return;if(!qe(r)){r=r[s];continue}let i=r,o=t.slice(n);return St(async()=>{let a=await Q(i),l=Ve(a.default,o);return Q(l)},Pr(i))}return r}function Nr(e){return new Proxy(e,{get(r,n){if(typeof n!="string")return Reflect.get(r,n);let s=Ve(e,[n]);return Nr(s)}})}function ze(e,t){if(qe(e)){let n=Pr(e),s=n?.prefix?$e(t.prefix,n?.prefix):t.prefix,i=St(async()=>{let{default:a}=await Q(e),l=ze(a,t);return Q(l)},{...n,prefix:s});return Nr(i)}if(_e(e)){let n=xi(t.middlewares,e["~orpc"].middlewares,{dedupeLeading:t.dedupeLeadingMiddlewares}),s=n.length-e["~orpc"].middlewares.length;return new be({...e["~orpc"],route:Tr(e["~orpc"].route,t),errorMap:we(t.errorMap,e["~orpc"].errorMap),middlewares:n,inputValidationIndex:e["~orpc"].inputValidationIndex+s,outputValidationIndex:e["~orpc"].outputValidationIndex+s})}let r={};for(let n in e)r[n]=ze(e[n],t);return r}function xt(e,t,r=[]){let n=e.router,s=Ri(e.router);if(s!==void 0&&(n=s),qe(n))r.push({router:n,path:e.path});else if(Me(n))t({contract:n,path:e.path});else for(let i in n)xt({router:n[i],path:[...e.path,i]},t,r);return r}function Mr(e,t){return new be({...e["~orpc"],errorMap:t["~orpc"].errorMap,route:t["~orpc"].route,meta:t["~orpc"].meta})}var Ue=class{plugins;constructor(t=[]){this.plugins=[...t].sort((r,n)=>(r.order??0)-(n.order??0))}init(t,r){for(let n of this.plugins)n.init?.(t,r)}},$r=class{constructor(t,r,n,s){this.matcher=r,this.codec=n,new Ue(s.plugins).init(s,t),this.interceptors=W(s.interceptors),this.clientInterceptors=W(s.clientInterceptors),this.rootInterceptors=W(s.rootInterceptors),this.matcher.init(t)}interceptors;clientInterceptors;rootInterceptors;async handle(t,r){let n=r.prefix?.replace(/\/$/,"")||void 0;return n&&!t.url.pathname.startsWith(`${n}/`)&&t.url.pathname!==n?{matched:!1,response:void 0}:re(this.rootInterceptors,{...r,request:t,prefix:n},async s=>j({name:`${t.method} ${t.url.pathname}`},async i=>{let o;try{return await re(this.interceptors,s,async({request:a,context:l,prefix:d})=>{let f=a.method,u=a.url,m=d?u.pathname.replace(d,""):u.pathname,h=await j({name:"find_procedure"},()=>this.matcher.match(f,`/${m.replace(/^\/|\/$/g,"")}`));if(!h)return{matched:!1,response:void 0};i?.updateName(`${lt}.${h.path.join("/")}`),i?.setAttribute("rpc.system",lt),i?.setAttribute("rpc.method",h.path.join(".")),o="decode_input";let c=await j({name:"decode_input"},()=>this.codec.decode(a,h.params,h.procedure));o=void 0,k(c)&&(c=Pe({name:"consume_event_iterator_input",signal:a.signal},c));let y=Fe(h.procedure,{context:l,path:h.path,interceptors:this.clientInterceptors});o="call_procedure";let g=await y(c,{signal:a.signal,lastEventId:pe(a.headers["last-event-id"])});return o=void 0,{matched:!0,response:this.codec.encode(g,h.procedure)}})}catch(a){o!=="call_procedure"&&V(i,a);let l=o==="decode_input"&&!(a instanceof A)?new A("BAD_REQUEST",{message:"Malformed request. Ensure the request body is properly formatted and the 'Content-Type' header is set correctly.",cause:a}):me(a);return{matched:!0,response:this.codec.encodeError(l)}}}))}},jr=class{constructor(t){this.serializer=t}async decode(t,r,n){let s=t.method==="GET"?ne(t.url.searchParams.getAll("data").at(-1)):await t.body();return this.serializer.deserialize(s)}encode(t,r){return{status:200,headers:{},body:this.serializer.serialize(t)}}encodeError(t){return{status:t.status,headers:{},body:this.serializer.serialize(t.toJSON())}}},kr=class{filter;tree=new oi;pendingRouters=[];constructor(t={}){this.filter=t.filter??!0}init(t,r=[]){let n=xt({router:t,path:r},s=>{if(!se(this.filter,s))return;let{path:i,contract:o}=s,a=De(i);_e(o)?this.tree[a]={path:i,contract:o,procedure:o,router:t}:this.tree[a]={path:i,contract:o,procedure:void 0,router:t}});this.pendingRouters.push(...n.map(s=>({...s,httpPathPrefix:De(s.path)})))}async match(t,r){if(this.pendingRouters.length){let s=[];for(let i of this.pendingRouters)if(r.startsWith(i.httpPathPrefix)){let{default:o}=await Q(i.router);this.init(o,i.path)}else s.push(i);this.pendingRouters=s}let n=this.tree[r];if(n){if(!n.procedure){let{default:s}=await Q(Ve(n.router,n.path));if(!_e(s))throw new Error(`
          [Contract-First] Missing or invalid implementation for procedure at path: ${De(n.path)}.
          Ensure that the procedure is correctly defined and matches the expected contract.
        `);n.procedure=Mr(s,n.contract)}return{path:n.path,procedure:n.procedure}}}},Et=class extends $r{constructor(t,r={}){let n=new je(r),s=new ke(n),i=new kr(r),o=new jr(s);super(t,i,o,r)}};var Dr=Symbol("STRICT_GET_METHOD_PLUGIN_IS_GET_METHOD_CONTEXT"),We=class{error;order=7e6;constructor(t={}){this.error=t.error??new A("METHOD_NOT_SUPPORTED")}init(t){t.rootInterceptors??=[],t.clientInterceptors??=[],t.rootInterceptors.unshift(r=>{let n=r.request.method==="GET";return r.next({...r,context:{...r.context,[Dr]:n}})}),t.clientInterceptors.unshift(r=>{if(typeof r.context[Dr]!="boolean")throw new TypeError("[StrictGetMethodPlugin] strict GET method context has been corrupted or modified by another plugin or interceptor");let n=Cr("defaultMethod",r.procedure["~orpc"].route.method);if(r.context[Dr]&&n!=="GET")throw this.error;return r.next()})}};var zr=class extends Ue{initRuntimeAdapter(t){for(let r of this.plugins)r.initRuntimeAdapter?.(t)}},Br=class{constructor(t,r={}){this.standardHandler=t,new zr(r.plugins).initRuntimeAdapter(r),this.adapterInterceptors=W(r.adapterInterceptors),this.toFetchResponseOptions=r}toFetchResponseOptions;adapterInterceptors;async handle(t,...r){return re(this.adapterInterceptors,{...wi(te(r)),request:t,toFetchResponseOptions:this.toFetchResponseOptions},async({request:n,toFetchResponseOptions:s,...i})=>{let o=gi(n),a=await this.standardHandler.handle(o,i);return a.matched?{matched:!0,response:yi(a.response,s)}:a})}},vt=class extends Br{constructor(t,r={}){(r.strictGetMethodPluginEnabled??!0)&&(r.plugins??=[],r.plugins.push(new We)),super(new Et(t,r),r)}};var Ot=class{options;order=9e6;constructor(t={}){let r={origin:n=>n,allowMethods:["GET","HEAD","PUT","POST","DELETE","PATCH"]};this.options={...r,...t}}init(t){t.rootInterceptors??=[],t.rootInterceptors.unshift(async r=>{if(r.request.method==="OPTIONS"){let n={};this.options.maxAge!==void 0&&(n["access-control-max-age"]=this.options.maxAge.toString()),this.options.allowMethods?.length&&(n["access-control-allow-methods"]=pe(this.options.allowMethods));let s=this.options.allowHeaders??r.request.headers["access-control-request-headers"];return(typeof s=="string"||s?.length)&&(n["access-control-allow-headers"]=pe(s)),{matched:!0,response:{status:204,headers:n,body:void 0}}}return r.next()}),t.rootInterceptors.unshift(async r=>{let n=await r.next();if(!n.matched)return n;let s=pe(r.request.headers.origin)??"",i=await se(this.options.origin,s,r),o=Array.isArray(i)?i:[i];o.includes("*")?n.response.headers["access-control-allow-origin"]="*":(o.includes(s)&&(n.response.headers["access-control-allow-origin"]=s),n.response.headers.vary=r.request.headers.vary??"origin");let a=await se(this.options.timingOrigin,s,r),l=Array.isArray(a)?a:[a];return l.includes("*")?n.response.headers["timing-allow-origin"]="*":l.includes(s)&&(n.response.headers["timing-allow-origin"]=s),this.options.credentials&&(n.response.headers["access-control-allow-credentials"]="true"),this.options.exposeHeaders?.length&&(n.response.headers["access-control-expose-headers"]=pe(this.options.exposeHeaders)),n})}};var Nm=Symbol("SIMPLE_CSRF_PROTECTION_CONTEXT");var If={initialInputValidationIndex:0,initialOutputValidationIndex:0,dedupeLeadingMiddlewares:!0};function J(e,t){return t===void 0?If[e]:t}function Re(e){let t=(...r)=>e(...r);return t.mapInput=r=>Re((s,i,...o)=>e(s,r(i),...o)),t.concat=(r,n)=>{let s=n?Re(r).mapInput(n):r;return Re((o,a,l,...d)=>e({...o,next:(...[u])=>s({...o,context:{...o.context,...u?.context},next:(...[m])=>o.next({context:{...u?.context,...m?.context}})},a,l,...d)},a,l,...d))},t}function Af(e){return async r=>{try{return[null,await e(r)]}catch(n){if(n instanceof Error&&"digest"in n&&typeof n.digest=="string"&&n.digest.startsWith("NEXT_"))throw n;return[me(n).toJSON(),void 0]}}}var qr=class e extends be{errors(t){return new e({...this["~orpc"],errorMap:we(this["~orpc"].errorMap,t)})}meta(t){return new e({...this["~orpc"],meta:wt(this["~orpc"].meta,t)})}route(t){return new e({...this["~orpc"],route:bt(this["~orpc"].route,t)})}use(t,r){let n=r?Re(t).mapInput(r):t;return new e({...this["~orpc"],middlewares:Lr(this["~orpc"].middlewares,n)})}callable(...t){let r=Fe(this,...t);return new Proxy(r,{get:(n,s)=>Reflect.has(this,s)?Reflect.get(this,s):Reflect.get(n,s),has:(n,s)=>Reflect.has(this,s)||Reflect.has(n,s)})}actionable(...t){let r=Af(Fe(this,...t));return new Proxy(r,{get:(n,s)=>Reflect.has(this,s)?Reflect.get(this,s):Reflect.get(n,s),has:(n,s)=>Reflect.has(this,s)||Reflect.has(n,s)})}},Fr=class e{"~orpc";constructor(t){this["~orpc"]=t}$config(t){let r=this["~orpc"].inputValidationIndex-J("initialInputValidationIndex",this["~orpc"].config.initialInputValidationIndex),n=this["~orpc"].outputValidationIndex-J("initialOutputValidationIndex",this["~orpc"].config.initialOutputValidationIndex);return new e({...this["~orpc"],config:t,dedupeLeadingMiddlewares:J("dedupeLeadingMiddlewares",t.dedupeLeadingMiddlewares),inputValidationIndex:J("initialInputValidationIndex",t.initialInputValidationIndex)+r,outputValidationIndex:J("initialOutputValidationIndex",t.initialOutputValidationIndex)+n})}$context(){return new e({...this["~orpc"],middlewares:[],inputValidationIndex:J("initialInputValidationIndex",this["~orpc"].config.initialInputValidationIndex),outputValidationIndex:J("initialOutputValidationIndex",this["~orpc"].config.initialOutputValidationIndex)})}$meta(t){return new e({...this["~orpc"],meta:t})}$route(t){return new e({...this["~orpc"],route:t})}$input(t){return new e({...this["~orpc"],inputSchema:t})}middleware(t){return Re(t)}errors(t){return new e({...this["~orpc"],errorMap:we(this["~orpc"].errorMap,t)})}use(t,r){let n=r?Re(t).mapInput(r):t;return new e({...this["~orpc"],middlewares:Lr(this["~orpc"].middlewares,n)})}meta(t){return new e({...this["~orpc"],meta:wt(this["~orpc"].meta,t)})}route(t){return new e({...this["~orpc"],route:bt(this["~orpc"].route,t)})}input(t){return new e({...this["~orpc"],inputSchema:t,inputValidationIndex:J("initialInputValidationIndex",this["~orpc"].config.initialInputValidationIndex)+this["~orpc"].middlewares.length})}output(t){return new e({...this["~orpc"],outputSchema:t,outputValidationIndex:J("initialOutputValidationIndex",this["~orpc"].config.initialOutputValidationIndex)+this["~orpc"].middlewares.length})}handler(t){return new qr({...this["~orpc"],handler:t})}prefix(t){return new e({...this["~orpc"],prefix:$e(this["~orpc"].prefix,t)})}tag(...t){return new e({...this["~orpc"],tags:Ar(this["~orpc"].tags,t)})}router(t){return ze(t,this["~orpc"])}lazy(t){return ze(St(t),this["~orpc"])}},Vr=new Fr({config:{},route:{},meta:{},errorMap:{},inputValidationIndex:J("initialInputValidationIndex"),outputValidationIndex:J("initialOutputValidationIndex"),middlewares:[],dedupeLeadingMiddlewares:!0});var Tf=(0,Ti.pino)({level:"info"}),Ii=Vr.handler(()=>"ping"),Ai=Vr.handler(()=>"pong"),Cf={ping:Ii,pong:Ai,nested:{ping:Ii,pong:Ai}},Pf=new vt(Cf,{plugins:[new Ot]}),sg={async fetch(e,t){Tf.child({req:e,inf:t}).info("Request received");let{matched:r,response:n}=await Pf.handle(e,{prefix:"/rpc",context:{}});return r?n:new Response("Not found",{status:404})}};export{sg as default};
